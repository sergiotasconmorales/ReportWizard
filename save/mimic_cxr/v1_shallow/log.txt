Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 4, in <module>
    from dataset.data_module import DataModule
  File "/storage/homefs/st20f757/vqa/ReportWizard/dataset/data_module.py", line 1, in <module>
    from lightning.pytorch import LightningDataModule
ModuleNotFoundError: No module named 'lightning'
Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 4, in <module>
    from dataset.data_module import DataModule
  File "/storage/homefs/st20f757/vqa/ReportWizard/dataset/data_module.py", line 3, in <module>
    from dataset.data_helper import create_datasets
  File "/storage/homefs/st20f757/vqa/ReportWizard/dataset/data_helper.py", line 6, in <module>
    from PIL import Image
ModuleNotFoundError: No module named 'PIL'
Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 4, in <module>
    from dataset.data_module import DataModule
  File "/storage/homefs/st20f757/vqa/ReportWizard/dataset/data_module.py", line 3, in <module>
    from dataset.data_helper import create_datasets
  File "/storage/homefs/st20f757/vqa/ReportWizard/dataset/data_helper.py", line 8, in <module>
    from transformers import BertTokenizer, AutoImageProcessor
ModuleNotFoundError: No module named 'transformers'
Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 6, in <module>
    from models.R2GenGPT import R2GenGPT
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 13, in <module>
    from peft import get_peft_model, LoraConfig, TaskType
ModuleNotFoundError: No module named 'peft'
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annnotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 4,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'meta-llama/Llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': False,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 13, in train
    callbacks = add_callbacks(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/lightning_tools/callbacks.py", line 23, in add_callbacks
    tb_logger = pl_loggers.TensorBoardLogger(save_dir=os.path.join(log_dir, "logs"), name="tensorboard")
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/loggers/tensorboard.py", line 109, in __init__
    super().__init__(
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/fabric/loggers/tensorboard.py", line 92, in __init__
    raise ModuleNotFoundError(
ModuleNotFoundError: Neither `tensorboard` nor `tensorboardX` is available. Try `pip install`ing either.
DistributionNotFound: The 'tensorboardX' distribution was not found and is required by the application. HINT: Try running `pip install -U 'tensorboardX'`
DistributionNotFound: The 'tensorboard' distribution was not found and is required by the application. HINT: Try running `pip install -U 'tensorboard'`
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annnotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 4,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'meta-llama/Llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': False,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Downloading (…)lve/main/config.json:   0%|          | 0.00/71.8k [00:00<?, ?B/s]Downloading (…)lve/main/config.json: 100%|██████████| 71.8k/71.8k [00:00<00:00, 787kB/s]
Downloading model.safetensors:   0%|          | 0.00/352M [00:00<?, ?B/s]Downloading model.safetensors:   3%|▎         | 10.5M/352M [00:00<00:27, 12.4MB/s]Downloading model.safetensors:   6%|▌         | 21.0M/352M [00:01<00:14, 22.1MB/s]Downloading model.safetensors:   9%|▉         | 31.5M/352M [00:01<00:11, 27.8MB/s]Downloading model.safetensors:  12%|█▏        | 41.9M/352M [00:01<00:10, 30.9MB/s]Downloading model.safetensors:  15%|█▍        | 52.4M/352M [00:02<00:10, 28.7MB/s]Downloading model.safetensors:  18%|█▊        | 62.9M/352M [00:02<00:10, 27.7MB/s]Downloading model.safetensors:  21%|██        | 73.4M/352M [00:02<00:10, 26.2MB/s]Downloading model.safetensors:  24%|██▍       | 83.9M/352M [00:03<00:11, 23.7MB/s]Downloading model.safetensors:  27%|██▋       | 94.4M/352M [00:03<00:09, 26.2MB/s]Downloading model.safetensors:  30%|██▉       | 105M/352M [00:04<00:09, 26.4MB/s] Downloading model.safetensors:  33%|███▎      | 115M/352M [00:04<00:08, 29.1MB/s]Downloading model.safetensors:  36%|███▌      | 126M/352M [00:04<00:08, 27.8MB/s]Downloading model.safetensors:  39%|███▉      | 136M/352M [00:05<00:07, 28.5MB/s]Downloading model.safetensors:  42%|████▏     | 147M/352M [00:05<00:06, 30.8MB/s]Downloading model.safetensors:  45%|████▍     | 157M/352M [00:05<00:06, 28.3MB/s]Downloading model.safetensors:  48%|████▊     | 168M/352M [00:06<00:06, 28.8MB/s]Downloading model.safetensors:  51%|█████     | 178M/352M [00:06<00:05, 32.6MB/s]Downloading model.safetensors:  54%|█████▎    | 189M/352M [00:06<00:04, 33.9MB/s]Downloading model.safetensors:  57%|█████▋    | 199M/352M [00:06<00:04, 34.6MB/s]Downloading model.safetensors:  60%|█████▉    | 210M/352M [00:07<00:04, 34.8MB/s]Downloading model.safetensors:  63%|██████▎   | 220M/352M [00:07<00:04, 31.6MB/s]Downloading model.safetensors:  66%|██████▌   | 231M/352M [00:08<00:03, 30.9MB/s]Downloading model.safetensors:  69%|██████▊   | 241M/352M [00:08<00:03, 29.3MB/s]Downloading model.safetensors:  72%|███████▏  | 252M/352M [00:08<00:03, 31.5MB/s]Downloading model.safetensors:  75%|███████▍  | 262M/352M [00:08<00:02, 33.4MB/s]Downloading model.safetensors:  78%|███████▊  | 273M/352M [00:09<00:02, 32.7MB/s]Downloading model.safetensors:  81%|████████  | 283M/352M [00:09<00:02, 29.2MB/s]Downloading model.safetensors:  84%|████████▎ | 294M/352M [00:10<00:02, 27.0MB/s]Downloading model.safetensors:  86%|████████▋ | 304M/352M [00:10<00:01, 26.1MB/s]Downloading model.safetensors:  89%|████████▉ | 315M/352M [00:11<00:01, 24.9MB/s]Downloading model.safetensors:  92%|█████████▏| 325M/352M [00:11<00:01, 25.5MB/s]Downloading model.safetensors:  95%|█████████▌| 336M/352M [00:12<00:00, 24.1MB/s]Downloading model.safetensors:  98%|█████████▊| 346M/352M [00:12<00:00, 26.8MB/s]Downloading model.safetensors: 100%|██████████| 352M/352M [00:12<00:00, 20.5MB/s]Downloading model.safetensors: 100%|██████████| 352M/352M [00:12<00:00, 27.3MB/s]
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.weight', 'classifier.bias']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 33, in train
    model = R2GenGPT(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 49, in __init__
    self.llama_tokenizer = LlamaTokenizer.from_pretrained(args.llama_model, use_fast=False)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1026, in __getattribute__
    requires_backends(cls, cls._backends)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1014, in requires_backends
    raise ImportError("".join(failed))
ImportError: 
LlamaTokenizer requires the SentencePiece library but it was not found in your environment. Checkout the instructions on the
installation page of its repo: https://github.com/google/sentencepiece#installation and follow the ones
that match your environment. Please note that you may need to restart your runtime after installation.

{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annnotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 4,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'meta-llama/Llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': False,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.weight', 'classifier.bias']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Traceback (most recent call last):
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/huggingface_hub/utils/_errors.py", line 261, in hf_raise_for_status
    response.raise_for_status()
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://huggingface.co/meta-llama/Llama-2-7b-chat-hf/resolve/main/tokenizer.model

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/transformers/utils/hub.py", line 417, in cached_file
    resolved_file = hf_hub_download(
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1344, in hf_hub_download
    raise head_call_error
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1230, in hf_hub_download
    metadata = get_hf_file_metadata(
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1606, in get_hf_file_metadata
    hf_raise_for_status(r)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/huggingface_hub/utils/_errors.py", line 277, in hf_raise_for_status
    raise GatedRepoError(message, response) from e
huggingface_hub.utils._errors.GatedRepoError: 401 Client Error. (Request ID: Root=1-6511a955-2a744f4753052b630afe49ca;3e6ac822-e892-44c3-b626-26102960b13b)

Cannot access gated repo for url https://huggingface.co/meta-llama/Llama-2-7b-chat-hf/resolve/main/tokenizer.model.
Repo model meta-llama/Llama-2-7b-chat-hf is gated. You must be authenticated to access it.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 33, in train
    model = R2GenGPT(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 49, in __init__
    self.llama_tokenizer = LlamaTokenizer.from_pretrained(args.llama_model, use_fast=False)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 1784, in from_pretrained
    resolved_vocab_files[file_id] = cached_file(
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/transformers/utils/hub.py", line 433, in cached_file
    raise EnvironmentError(
OSError: meta-llama/Llama-2-7b-chat-hf is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo with `use_auth_token` or log in with `huggingface-cli login` and pass `use_auth_token=True`.
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annnotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 4,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'daryl149/llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': False,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.bias', 'classifier.weight']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:15<00:15, 15.62s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:20<00:00,  9.54s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:20<00:00, 10.45s/it]
Loading LLAMA Done
[rank: 0] Global seed set to 42
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 40, in train
    trainer.fit(model, datamodule=dm)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 529, in fit
    call._call_and_handle_interrupt(
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/trainer/call.py", line 41, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/strategies/launchers/subprocess_script.py", line 91, in launch
    return function(*args, **kwargs)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 568, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 934, in _run
    call._call_setup_hook(self)  # allow user to setup lightning_module in accelerator environment
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/trainer/call.py", line 83, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/trainer/call.py", line 164, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/storage/homefs/st20f757/vqa/ReportWizard/dataset/data_module.py", line 44, in setup
    train_dataset, dev_dataset, test_dataset = create_datasets(self.args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/dataset/data_helper.py", line 93, in create_datasets
    train_dataset = ParseDataset(args, 'train')
  File "/storage/homefs/st20f757/vqa/ReportWizard/dataset/data_helper.py", line 81, in __init__
    self.meta = json.load(open(args.annotation, 'r'))
FileNotFoundError: [Errno 2] No such file or directory: './data/mimic_cxr/annnotation.json'
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 4,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'daryl149/llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': False,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.weight', 'classifier.bias']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:15<00:15, 15.06s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:20<00:00,  9.37s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:20<00:00, 10.22s/it]
Loading LLAMA Done
[rank: 0] Global seed set to 42
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Downloading (…)rocessor_config.json:   0%|          | 0.00/255 [00:00<?, ?B/s]Downloading (…)rocessor_config.json: 100%|██████████| 255/255 [00:00<00:00, 2.07MB/s]
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]

  | Name           | Type             | Params
----------------------------------------------------
0 | visual_encoder | SwinModel        | 86.7 M
1 | llama_model    | LlamaForCausalLM | 6.7 B 
2 | embed_tokens   | Embedding        | 131 M 
3 | llama_proj     | Linear           | 4.2 M 
4 | layer_norm     | LayerNorm        | 8.2 K 
----------------------------------------------------
4.2 M     Trainable params
6.8 B     Non-trainable params
6.8 B     Total params
27,317.462Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Sanity Checking: 0it [00:00, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 40, in train
    trainer.fit(model, datamodule=dm)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 529, in fit
    call._call_and_handle_interrupt(
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/trainer/call.py", line 41, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/strategies/launchers/subprocess_script.py", line 91, in launch
    return function(*args, **kwargs)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 568, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 973, in _run
    results = self._run_stage()
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 1014, in _run_stage
    self._run_sanity_check()
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 1043, in _run_sanity_check
    val_loop.run()
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/trainer/call.py", line 291, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/strategies/ddp.py", line 336, in validation_step
    return self.model(*args, **kwargs)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1156, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1110, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])  # type: ignore[index]
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/overrides/base.py", line 102, in forward
    return self._forward_module.validation_step(*inputs, **kwargs)
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 249, in validation_step
    outputs = self.llama_model.generate(
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/transformers/generation/utils.py", line 1611, in generate
    return self.beam_search(
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/transformers/generation/utils.py", line 2909, in beam_search
    outputs = self(
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 688, in forward
    outputs = self.model(
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 578, in forward
    layer_outputs = decoder_layer(
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 292, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 208, in forward
    value_states = torch.cat([past_key_value[1], value_states], dim=2)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 46.00 MiB (GPU 0; 23.70 GiB total capacity; 21.33 GiB already allocated; 30.69 MiB free; 22.30 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
                                                                   /storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/torch/cuda/__init__.py:546: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/torch/cuda/__init__.py:651: UserWarning: CUDA initialization: CUDA driver initialization failed, you might not have a CUDA gpu. (Triggered internally at ../c10/cuda/CUDAFunctions.cpp:109.)
  return torch._C._cuda_getDeviceCount() if nvml_count < 0 else nvml_count
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 8,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'daryl149/llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': False,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 15, in train
    trainer = pl.Trainer(
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/utilities/argparse.py", line 69, in insert_env_defaults
    return fn(self, **kwargs)
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 398, in __init__
    self._accelerator_connector = _AcceleratorConnector(
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 154, in __init__
    self._accelerator_flag = self._choose_gpu_accelerator_backend()
  File "/storage/homefs/st20f757/.conda/envs/reportwizard/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 366, in _choose_gpu_accelerator_backend
    raise MisconfigurationException("No supported gpu backend found!")
lightning.fabric.utilities.exceptions.MisconfigurationException: No supported gpu backend found!
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 8,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'daryl149/llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': False,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 15, in train
    trainer = pl.Trainer(
              ^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/utilities/argparse.py", line 69, in insert_env_defaults
    return fn(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 398, in __init__
    self._accelerator_connector = _AcceleratorConnector(
                                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 157, in __init__
    self._set_parallel_devices_and_init_accelerator()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 389, in _set_parallel_devices_and_init_accelerator
    self._devices_flag = accelerator_cls.parse_devices(self._devices_flag)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/accelerators/cuda.py", line 81, in parse_devices
    return _parse_gpu_ids(devices, include_cuda=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/utilities/device_parser.py", line 102, in _parse_gpu_ids
    return _sanitize_gpu_ids(gpus, include_cuda=include_cuda, include_mps=include_mps)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/utilities/device_parser.py", line 134, in _sanitize_gpu_ids
    raise MisconfigurationException(
lightning.fabric.utilities.exceptions.MisconfigurationException: You requested gpu: [0, 1, 2, 3, 4, 5, 6, 7]
 But your machine only has: [0, 1, 2, 3, 4, 5]
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 6,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'daryl149/llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': False,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.bias', 'classifier.weight']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:14<00:14, 14.69s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:19<00:00,  9.07s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:19<00:00,  9.91s/it]
Loading LLAMA Done
[rank: 0] Global seed set to 42
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5]

  | Name           | Type             | Params
----------------------------------------------------
0 | visual_encoder | SwinModel        | 86.7 M
1 | llama_model    | LlamaForCausalLM | 6.7 B 
2 | embed_tokens   | Embedding        | 131 M 
3 | llama_proj     | Linear           | 4.2 M 
4 | layer_norm     | LayerNorm        | 8.2 K 
----------------------------------------------------
4.2 M     Trainable params
6.8 B     Non-trainable params
6.8 B     Total params
27,317.462Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Sanity Checking: 0it [00:00, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 40, in train
    trainer.fit(model, datamodule=dm)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 529, in fit
    call._call_and_handle_interrupt(
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 41, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/strategies/launchers/subprocess_script.py", line 91, in launch
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 568, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 973, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1014, in _run_stage
    self._run_sanity_check()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1043, in _run_sanity_check
    val_loop.run()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 291, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/strategies/ddp.py", line 336, in validation_step
    return self.model(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1156, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1110, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])  # type: ignore[index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/overrides/base.py", line 102, in forward
    return self._forward_module.validation_step(*inputs, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 249, in validation_step
    outputs = self.llama_model.generate(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/generation/utils.py", line 1611, in generate
    return self.beam_search(
           ^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/generation/utils.py", line 2909, in beam_search
    outputs = self(
              ^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 688, in forward
    outputs = self.model(
              ^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 578, in forward
    layer_outputs = decoder_layer(
                    ^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 292, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
                                                          ^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 208, in forward
    value_states = torch.cat([past_key_value[1], value_states], dim=2)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 46.00 MiB (GPU 0; 23.70 GiB total capacity; 21.33 GiB already allocated; 30.69 MiB free; 22.30 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
                                                                   {'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 7,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'daryl149/llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': False,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.bias', 'classifier.weight']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:14<00:14, 14.97s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:20<00:00,  9.51s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:20<00:00, 10.33s/it]
Loading LLAMA Done
[rank: 0] Global seed set to 42
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6]

  | Name           | Type             | Params
----------------------------------------------------
0 | visual_encoder | SwinModel        | 86.7 M
1 | llama_model    | LlamaForCausalLM | 6.7 B 
2 | embed_tokens   | Embedding        | 131 M 
3 | llama_proj     | Linear           | 4.2 M 
4 | layer_norm     | LayerNorm        | 8.2 K 
----------------------------------------------------
4.2 M     Trainable params
6.8 B     Non-trainable params
6.8 B     Total params
27,317.462Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Sanity Checking: 0it [00:00, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 40, in train
    trainer.fit(model, datamodule=dm)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 529, in fit
    call._call_and_handle_interrupt(
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 41, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/strategies/launchers/subprocess_script.py", line 91, in launch
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 568, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 973, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1014, in _run_stage
    self._run_sanity_check()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1043, in _run_sanity_check
    val_loop.run()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 291, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/strategies/ddp.py", line 336, in validation_step
    return self.model(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1156, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1110, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])  # type: ignore[index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/overrides/base.py", line 102, in forward
    return self._forward_module.validation_step(*inputs, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 249, in validation_step
    outputs = self.llama_model.generate(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/generation/utils.py", line 1611, in generate
    return self.beam_search(
           ^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/generation/utils.py", line 2909, in beam_search
    outputs = self(
              ^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 688, in forward
    outputs = self.model(
              ^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 578, in forward
    layer_outputs = decoder_layer(
                    ^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 292, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
                                                          ^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 208, in forward
    value_states = torch.cat([past_key_value[1], value_states], dim=2)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 46.00 MiB (GPU 0; 23.70 GiB total capacity; 21.33 GiB already allocated; 30.69 MiB free; 22.30 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
                                                                   {'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 7,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'meta-llama/Llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': False,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.weight', 'classifier.bias']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Traceback (most recent call last):
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_errors.py", line 261, in hf_raise_for_status
    response.raise_for_status()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://huggingface.co/meta-llama/Llama-2-7b-chat-hf/resolve/main/tokenizer.model

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/utils/hub.py", line 417, in cached_file
    resolved_file = hf_hub_download(
                    ^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1346, in hf_hub_download
    raise head_call_error
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1232, in hf_hub_download
    metadata = get_hf_file_metadata(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1608, in get_hf_file_metadata
    hf_raise_for_status(r)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_errors.py", line 277, in hf_raise_for_status
    raise GatedRepoError(message, response) from e
huggingface_hub.utils._errors.GatedRepoError: 401 Client Error. (Request ID: Root=1-6512a932-4382350c0255693f37e3329e;ab8ab06d-f707-40cf-8a0e-0ea5a9e19259)

Cannot access gated repo for url https://huggingface.co/meta-llama/Llama-2-7b-chat-hf/resolve/main/tokenizer.model.
Repo model meta-llama/Llama-2-7b-chat-hf is gated. You must be authenticated to access it.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 33, in train
    model = R2GenGPT(args)
            ^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 49, in __init__
    self.llama_tokenizer = LlamaTokenizer.from_pretrained(args.llama_model, use_fast=False)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 1784, in from_pretrained
    resolved_vocab_files[file_id] = cached_file(
                                    ^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/utils/hub.py", line 433, in cached_file
    raise EnvironmentError(
OSError: meta-llama/Llama-2-7b-chat-hf is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo with `use_auth_token` or log in with `huggingface-cli login` and pass `use_auth_token=True`.
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 7,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'meta-llama/Llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': False,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.weight', 'classifier.bias']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Traceback (most recent call last):
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_errors.py", line 261, in hf_raise_for_status
    response.raise_for_status()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://huggingface.co/meta-llama/Llama-2-7b-chat-hf/resolve/main/tokenizer.model

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/utils/hub.py", line 417, in cached_file
    resolved_file = hf_hub_download(
                    ^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1346, in hf_hub_download
    raise head_call_error
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1232, in hf_hub_download
    metadata = get_hf_file_metadata(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1608, in get_hf_file_metadata
    hf_raise_for_status(r)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_errors.py", line 277, in hf_raise_for_status
    raise GatedRepoError(message, response) from e
huggingface_hub.utils._errors.GatedRepoError: 401 Client Error. (Request ID: Root=1-6512aab5-7e6cd3b52344f39869771b55;2213966d-a9b2-4917-8d5e-23be2eb6a193)

Cannot access gated repo for url https://huggingface.co/meta-llama/Llama-2-7b-chat-hf/resolve/main/tokenizer.model.
Repo model meta-llama/Llama-2-7b-chat-hf is gated. You must be authenticated to access it.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 33, in train
    model = R2GenGPT(args)
            ^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 49, in __init__
    self.llama_tokenizer = LlamaTokenizer.from_pretrained(args.llama_model, use_fast=False, token='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')
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 1784, in from_pretrained
    resolved_vocab_files[file_id] = cached_file(
                                    ^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/utils/hub.py", line 433, in cached_file
    raise EnvironmentError(
OSError: meta-llama/Llama-2-7b-chat-hf is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo with `use_auth_token` or log in with `huggingface-cli login` and pass `use_auth_token=True`.
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 4,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'daryl149/llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': True,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.bias', 'classifier.weight']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 33, in train
    model = R2GenGPT(args)
            ^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 52, in __init__
    self.llama_model = LlamaForCausalLM.from_pretrained(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2257, in from_pretrained
    raise ImportError(
ImportError: Using `load_in_8bit=True` requires Accelerate: `pip install accelerate` and the latest version of bitsandbytes `pip install -i https://test.pypi.org/simple/ bitsandbytes` or pip install bitsandbytes` 

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cextension.py:34: UserWarning: The installed version of bitsandbytes was compiled without GPU support. 8-bit optimizers, 8-bit multiplication, and GPU quantization are unavailable.
  warn("The installed version of bitsandbytes was compiled without GPU support. "
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cpu.so: undefined symbol: cadam32bit_grad_fp32
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /storage/homefs/st20f757/.conda/envs/rw did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /software.el7/software/zlib/1.2.11/lib:/software.el7/software/HDF5/1.12.1-gompi-2021a/lib:/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib:/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib:/software.el7/software/FFTW/3.3.9-gompi-2021a/lib:/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib:/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib:/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib:/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib:/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib:/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib:/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib:/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib:/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib:/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib:/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib:/software.el7/software/GCCcore/10.3.0/lib64 did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share'), PosixPath('1;/storage/homefs/st20f757/.local/share/flatpak/exports/share'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share'), PosixPath('1'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share'), PosixPath('1;/usr/local/share'), PosixPath('1;/var/lib/flatpak/exports/share'), PosixPath('1;/usr/share'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/GCCcore/10.3.0'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('GCCcore/10.3.0'), PosixPath('1;FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;GCC/10.3.0'), PosixPath('1;libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('1;ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1'), PosixPath('1;numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;HDF5/1.12.1-gompi-2021a'), PosixPath('1;libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('1;gompi/2021a'), PosixPath('1;OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;FFTW/3.3.9-gompi-2021a'), PosixPath('1;OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('1;hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;foss/2021a'), PosixPath('1;XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('1;Anaconda3/2021.11-foss-2021a'), PosixPath('1;zlib/.1.2.11'), PosixPath('1;UCX/1.10.0-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/modulefiles/all/foss/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/FlexiBLAS/3.0.4-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/Anaconda3/2021.11-foss-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/binutils/.2.36.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/FFTW/3.3.9-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/zlib/.1.2.11.lua'), PosixPath('1;/software.el7/modulefiles/all/Szip/.2.1.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/UCX/1.10.0-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/ScaLAPACK/2.1.0-gompi-2021a-fb.lua'), PosixPath('1;/software.el7/modulefiles/all/libpciaccess/.0.16-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenMPI/4.1.1-GCC-10.3.0.lua'), PosixPath('1'), PosixPath('1;/software.el7/modulefiles/all/HDF5/1.12.1-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/libfabric/1.12.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/gompi/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/libxml2/.2.9.10-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/hwloc/2.4.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/numactl/2.0.14-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/XZ/.5.2.5-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenBLAS/0.3.15-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/GCC/10.3.0.lua')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('UCX/1.10.0-GCCcore-10.3.0'), PosixPath('FFTW/3.3.9-gompi-2021a'), PosixPath('binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('numactl/2.0.14-GCCcore-10.3.0'), PosixPath('ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('GCC/10.3.0'), PosixPath('foss/2021a'), PosixPath('GCCcore/10.3.0'), PosixPath('hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('HDF5/1.12.1-gompi-2021a'), PosixPath('libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('gompi/2021a'), PosixPath('FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('zlib/.1.2.11'), PosixPath('Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('Anaconda3/2021.11-foss-2021a'), PosixPath('libxml2/.2.9.10-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/usr/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/bin'), PosixPath('2;/storage/homefs/st20f757/bin'), PosixPath('2;/usr/local/bin'), PosixPath('1;/usr/local/sbin'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/bin'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/bin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/sbin'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/bin'), PosixPath('1;/storage/homefs/st20f757/.local/bin'), PosixPath('1;/software.el7/lmod/lmod/libexec'), PosixPath('2;/opt/puppetlabs/bin'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/bin'), PosixPath('1;/usr/sbin'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/bin'), PosixPath('2'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/sbin'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/bin'), PosixPath('1;/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/google-cloud-sdk/bin'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/bin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/bin'), PosixPath('1;/usr/lpp/mmfs/bin')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('+/usr/share/gnudatalanguage')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/include'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include/libxml2'), PosixPath('1'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/include/flexiblas'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/include'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/include')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/lib64'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib/pkgconfig'), PosixPath('1'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/zlib/1.2.11/lib/pkgconfig'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib/pkgconfig')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share/man'), PosixPath('1;/opt/puppetlabs/puppet/share/man'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/man'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share/man'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share/man'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share/man'), PosixPath('1'), PosixPath('1;/software.el7/software/zlib/1.2.11/share/man'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share/man')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('() {  eval $($LMOD_DIR/ml_cmd "$@")\n}')}
  warn(msg)
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/usr/local/cuda/lib64')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: No libcudart.so found! Install CUDA or the cudatoolkit package (anaconda)!
  warn(msg)
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cpu.so...
Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 6, in <module>
    from models.R2GenGPT import R2GenGPT
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 13, in <module>
    from peft import get_peft_model, LoraConfig, TaskType
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/peft/__init__.py", line 22, in <module>
    from .auto import (
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/peft/auto.py", line 31, in <module>
    from .mapping import MODEL_TYPE_TO_PEFT_MODEL_MAPPING
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/peft/mapping.py", line 23, in <module>
    from .peft_model import (
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/peft/peft_model.py", line 38, in <module>
    from .tuners import (
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/peft/tuners/__init__.py", line 21, in <module>
    from .lora import LoraConfig, LoraModel
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/peft/tuners/lora.py", line 45, in <module>
    import bitsandbytes as bnb
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/__init__.py", line 6, in <module>
    from . import cuda_setup, utils, research
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/research/__init__.py", line 1, in <module>
    from . import nn
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/research/nn/__init__.py", line 1, in <module>
    from .modules import LinearFP8Mixed, LinearFP8Global
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/research/nn/modules.py", line 8, in <module>
    from bitsandbytes.optim import GlobalOptimManager
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/optim/__init__.py", line 8, in <module>
    from .adagrad import Adagrad, Adagrad8bit, Adagrad32bit
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/optim/adagrad.py", line 5, in <module>
    from bitsandbytes.optim.optimizer import Optimizer1State
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/optim/optimizer.py", line 12, in <module>
    import bitsandbytes.functional as F
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/functional.py", line 12, in <module>
    from scipy.stats import norm
ModuleNotFoundError: No module named 'scipy'

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cextension.py:34: UserWarning: The installed version of bitsandbytes was compiled without GPU support. 8-bit optimizers, 8-bit multiplication, and GPU quantization are unavailable.
  warn("The installed version of bitsandbytes was compiled without GPU support. "
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cpu.so: undefined symbol: cadam32bit_grad_fp32
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /storage/homefs/st20f757/.conda/envs/rw did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /software.el7/software/zlib/1.2.11/lib:/software.el7/software/HDF5/1.12.1-gompi-2021a/lib:/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib:/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib:/software.el7/software/FFTW/3.3.9-gompi-2021a/lib:/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib:/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib:/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib:/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib:/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib:/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib:/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib:/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib:/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib:/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib:/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib:/software.el7/software/GCCcore/10.3.0/lib64 did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/var/lib/flatpak/exports/share'), PosixPath('1;/usr/share'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share'), PosixPath('1'), PosixPath('1;/usr/local/share'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share'), PosixPath('1;/storage/homefs/st20f757/.local/share/flatpak/exports/share'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/GCCcore/10.3.0'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('1;GCC/10.3.0'), PosixPath('1;libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('1;Anaconda3/2021.11-foss-2021a'), PosixPath('1;XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('1;zlib/.1.2.11'), PosixPath('1'), PosixPath('1;FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('1;OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;FFTW/3.3.9-gompi-2021a'), PosixPath('1;gompi/2021a'), PosixPath('1;hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;HDF5/1.12.1-gompi-2021a'), PosixPath('1;binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('1;libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;foss/2021a'), PosixPath('GCCcore/10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/modulefiles/all/zlib/.1.2.11.lua'), PosixPath('1;/software.el7/modulefiles/all/ScaLAPACK/2.1.0-gompi-2021a-fb.lua'), PosixPath('1;/software.el7/modulefiles/all/GCC/10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/HDF5/1.12.1-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/XZ/.5.2.5-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libpciaccess/.0.16-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/binutils/.2.36.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenMPI/4.1.1-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/FlexiBLAS/3.0.4-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/numactl/2.0.14-GCCcore-10.3.0.lua'), PosixPath('1'), PosixPath('1;/software.el7/modulefiles/all/UCX/1.10.0-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/gompi/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/Anaconda3/2021.11-foss-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/hwloc/2.4.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/FFTW/3.3.9-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenBLAS/0.3.15-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/Szip/.2.1.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libfabric/1.12.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libxml2/.2.9.10-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/foss/2021a.lua')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('foss/2021a'), PosixPath('HDF5/1.12.1-gompi-2021a'), PosixPath('ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('FFTW/3.3.9-gompi-2021a'), PosixPath('hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('gompi/2021a'), PosixPath('OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('zlib/.1.2.11'), PosixPath('libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('numactl/2.0.14-GCCcore-10.3.0'), PosixPath('libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('Anaconda3/2021.11-foss-2021a'), PosixPath('GCC/10.3.0'), PosixPath('binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('UCX/1.10.0-GCCcore-10.3.0'), PosixPath('GCCcore/10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/usr/local/sbin'), PosixPath('2'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/bin'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/sbin'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/bin'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/bin'), PosixPath('1;/usr/bin'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/bin'), PosixPath('2;/storage/homefs/st20f757/bin'), PosixPath('1;/usr/lpp/mmfs/bin'), PosixPath('1;/software.el7/lmod/lmod/libexec'), PosixPath('1;/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/google-cloud-sdk/bin'), PosixPath('2;/opt/puppetlabs/bin'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/bin'), PosixPath('1;/usr/sbin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/sbin'), PosixPath('1;/storage/homefs/st20f757/.local/bin'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/bin'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/bin'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/bin'), PosixPath('2;/usr/local/bin')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('+/usr/share/gnudatalanguage')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/include'), PosixPath('1'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include/libxml2'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/include'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/include/flexiblas'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/include')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/lib64'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib/pkgconfig'), PosixPath('1'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/zlib/1.2.11/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib/pkgconfig'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib/pkgconfig')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/man'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/zlib/1.2.11/share/man'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share/man'), PosixPath('1;/opt/puppetlabs/puppet/share/man'), PosixPath('1'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share/man'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share/man'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share/man')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('() {  eval $($LMOD_DIR/ml_cmd "$@")\n}')}
  warn(msg)
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/usr/local/cuda/lib64')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: No libcudart.so found! Install CUDA or the cudatoolkit package (anaconda)!
  warn(msg)
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cpu.so...
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 4,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'daryl149/llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': True,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.bias', 'classifier.weight']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:16<?, ?it/s]
Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 33, in train
    model = R2GenGPT(args)
            ^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 52, in __init__
    self.llama_model = LlamaForCausalLM.from_pretrained(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2881, in from_pretrained
    ) = cls._load_pretrained_model(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/modeling_utils.py", line 3228, in _load_pretrained_model
    new_error_msgs, offload_index, state_dict_index = _load_state_dict_into_meta_model(
                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/modeling_utils.py", line 728, in _load_state_dict_into_meta_model
    set_module_quantized_tensor_to_device(
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/utils/bitsandbytes.py", line 89, in set_module_quantized_tensor_to_device
    new_value = bnb.nn.Int8Params(new_value, requires_grad=False, **kwargs).to(device)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/nn/modules.py", line 294, in to
    return self.cuda(device)
           ^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/nn/modules.py", line 258, in cuda
    CB, CBt, SCB, SCBt, coo_tensorB = bnb.functional.double_quant(B)
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/functional.py", line 2058, in double_quant
    row_stats, col_stats, nnz_row_ptr = get_colrow_absmax(
                                        ^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/functional.py", line 1947, in get_colrow_absmax
    lib.cget_col_row_stats(ptrA, ptrRowStats, ptrColStats, ptrNnzrows, ct.c_float(threshold), rows, cols)
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/ctypes/__init__.py", line 389, in __getattr__
    func = self.__getitem__(name)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/ctypes/__init__.py", line 394, in __getitem__
    func = self._FuncPtr((name_or_ordinal, self))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: /storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cpu.so: undefined symbol: cget_col_row_stats

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /storage/homefs/st20f757/.conda/envs/rw did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /software.el7/software/zlib/1.2.11/lib:/software.el7/software/HDF5/1.12.1-gompi-2021a/lib:/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib:/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib:/software.el7/software/FFTW/3.3.9-gompi-2021a/lib:/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib:/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib:/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib:/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib:/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib:/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib:/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib:/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib:/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib:/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib:/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib:/software.el7/software/GCCcore/10.3.0/lib64 did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/var/lib/flatpak/exports/share'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share'), PosixPath('1;/storage/homefs/st20f757/.local/share/flatpak/exports/share'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share'), PosixPath('1;/usr/local/share'), PosixPath('1;/usr/share'), PosixPath('1'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/GCCcore/10.3.0'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('1;OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('1;numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;HDF5/1.12.1-gompi-2021a'), PosixPath('1;FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;foss/2021a'), PosixPath('1;UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;gompi/2021a'), PosixPath('1;XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('GCCcore/10.3.0'), PosixPath('1;Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('1'), PosixPath('1;libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('1;FFTW/3.3.9-gompi-2021a'), PosixPath('1;Anaconda3/2021.11-foss-2021a'), PosixPath('1;GCC/10.3.0'), PosixPath('1;zlib/.1.2.11')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/modulefiles/all/XZ/.5.2.5-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenBLAS/0.3.15-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libxml2/.2.9.10-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/FlexiBLAS/3.0.4-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/Szip/.2.1.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/zlib/.1.2.11.lua'), PosixPath('1;/software.el7/modulefiles/all/hwloc/2.4.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/UCX/1.10.0-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libpciaccess/.0.16-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/Anaconda3/2021.11-foss-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/FFTW/3.3.9-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/ScaLAPACK/2.1.0-gompi-2021a-fb.lua'), PosixPath('1;/software.el7/modulefiles/all/numactl/2.0.14-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/binutils/.2.36.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/GCC/10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/HDF5/1.12.1-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/gompi/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/foss/2021a.lua'), PosixPath('1'), PosixPath('1;/software.el7/modulefiles/all/libfabric/1.12.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenMPI/4.1.1-GCC-10.3.0.lua')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('UCX/1.10.0-GCCcore-10.3.0'), PosixPath('foss/2021a'), PosixPath('gompi/2021a'), PosixPath('HDF5/1.12.1-gompi-2021a'), PosixPath('binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('numactl/2.0.14-GCCcore-10.3.0'), PosixPath('Anaconda3/2021.11-foss-2021a'), PosixPath('XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('GCC/10.3.0'), PosixPath('libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('GCCcore/10.3.0'), PosixPath('zlib/.1.2.11'), PosixPath('OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('FFTW/3.3.9-gompi-2021a')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/bin'), PosixPath('1;/usr/bin'), PosixPath('2'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/bin'), PosixPath('1;/usr/lpp/mmfs/bin'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/bin'), PosixPath('2;/opt/puppetlabs/bin'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/bin'), PosixPath('1;/storage/homefs/st20f757/.local/bin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/bin'), PosixPath('1;/usr/local/sbin'), PosixPath('1;/usr/sbin'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/bin'), PosixPath('2;/usr/local/bin'), PosixPath('1;/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/google-cloud-sdk/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/sbin'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/bin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/sbin'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/lmod/lmod/libexec'), PosixPath('2;/storage/homefs/st20f757/bin')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('+/usr/share/gnudatalanguage')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/include'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/include'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/include/flexiblas'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include/libxml2'), PosixPath('1'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/include')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/lib64'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib/pkgconfig'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/zlib/1.2.11/lib/pkgconfig'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib/pkgconfig')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share/man'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share/man'), PosixPath('1;/opt/puppetlabs/puppet/share/man'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share/man'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/man'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share/man'), PosixPath('1'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/zlib/1.2.11/share/man')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('() {  eval $($LMOD_DIR/ml_cmd "$@")\n}')}
  warn(msg)
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/usr/local/cuda/lib64')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: No libcudart.so found! Install CUDA or the cudatoolkit package (anaconda)!
  warn(msg)
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cpu.so...
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 4,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'daryl149/llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': True,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.bias', 'classifier.weight']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:18<00:18, 18.86s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:25<00:00, 11.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:25<00:00, 12.60s/it]
Loading LLAMA Done
[rank: 0] Global seed set to 42
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]

  | Name           | Type             | Params
----------------------------------------------------
0 | visual_encoder | SwinModel        | 86.7 M
1 | llama_model    | LlamaForCausalLM | 6.7 B 
2 | embed_tokens   | Embedding        | 131 M 
3 | llama_proj     | Linear           | 4.2 M 
4 | layer_norm     | LayerNorm        | 8.2 K 
----------------------------------------------------
4.2 M     Trainable params
6.8 B     Non-trainable params
6.8 B     Total params
27,317.462Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Sanity Checking: 0it [00:00, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py:318: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 40, in train
    trainer.fit(model, datamodule=dm)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 529, in fit
    call._call_and_handle_interrupt(
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 41, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/strategies/launchers/subprocess_script.py", line 91, in launch
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 568, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 973, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1014, in _run_stage
    self._run_sanity_check()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1043, in _run_sanity_check
    val_loop.run()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 291, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/strategies/ddp.py", line 336, in validation_step
    return self.model(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1156, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1110, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])  # type: ignore[index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/overrides/base.py", line 102, in forward
    return self._forward_module.validation_step(*inputs, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 249, in validation_step
    outputs = self.llama_model.generate(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/generation/utils.py", line 1611, in generate
    return self.beam_search(
           ^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/generation/utils.py", line 2909, in beam_search
    outputs = self(
              ^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 688, in forward
    outputs = self.model(
              ^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 578, in forward
    layer_outputs = decoder_layer(
                    ^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 289, in forward
    hidden_states = self.input_layernorm(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 88, in forward
    return (self.weight * hidden_states).to(input_dtype)
            ~~~~~~~~~~~~^~~~~~~~~~~~~~~
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cuda:1!
                                                                   
===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /storage/homefs/st20f757/.conda/envs/rw did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /software.el7/software/zlib/1.2.11/lib:/software.el7/software/HDF5/1.12.1-gompi-2021a/lib:/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib:/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib:/software.el7/software/FFTW/3.3.9-gompi-2021a/lib:/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib:/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib:/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib:/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib:/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib:/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib:/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib:/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib:/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib:/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib:/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib:/software.el7/software/GCCcore/10.3.0/lib64 did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share'), PosixPath('1'), PosixPath('1;/usr/local/share'), PosixPath('1;/storage/homefs/st20f757/.local/share/flatpak/exports/share'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share'), PosixPath('1;/var/lib/flatpak/exports/share'), PosixPath('1;/usr/share'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;/software.el7/software/GCCcore/10.3.0'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1'), PosixPath('1;HDF5/1.12.1-gompi-2021a'), PosixPath('1;libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('1;Anaconda3/2021.11-foss-2021a'), PosixPath('1;ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;FFTW/3.3.9-gompi-2021a'), PosixPath('1;gompi/2021a'), PosixPath('1;hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;GCC/10.3.0'), PosixPath('1;libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('1;binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('1;zlib/.1.2.11'), PosixPath('1;OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('GCCcore/10.3.0'), PosixPath('1;foss/2021a'), PosixPath('1;UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('1;Szip/.2.1.1-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/modulefiles/all/zlib/.1.2.11.lua'), PosixPath('1;/software.el7/modulefiles/all/libpciaccess/.0.16-GCCcore-10.3.0.lua'), PosixPath('1'), PosixPath('1;/software.el7/modulefiles/all/XZ/.5.2.5-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/hwloc/2.4.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libxml2/.2.9.10-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/HDF5/1.12.1-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenMPI/4.1.1-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/Szip/.2.1.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/ScaLAPACK/2.1.0-gompi-2021a-fb.lua'), PosixPath('1;/software.el7/modulefiles/all/UCX/1.10.0-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/gompi/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/numactl/2.0.14-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/FFTW/3.3.9-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/FlexiBLAS/3.0.4-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/Anaconda3/2021.11-foss-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/GCC/10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/foss/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/binutils/.2.36.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenBLAS/0.3.15-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libfabric/1.12.1-GCCcore-10.3.0.lua')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('numactl/2.0.14-GCCcore-10.3.0'), PosixPath('libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('UCX/1.10.0-GCCcore-10.3.0'), PosixPath('ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('Anaconda3/2021.11-foss-2021a'), PosixPath('zlib/.1.2.11'), PosixPath('FFTW/3.3.9-gompi-2021a'), PosixPath('binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('gompi/2021a'), PosixPath('FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('GCC/10.3.0'), PosixPath('HDF5/1.12.1-gompi-2021a'), PosixPath('GCCcore/10.3.0'), PosixPath('foss/2021a'), PosixPath('OpenMPI/4.1.1-GCC-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/usr/local/sbin'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/bin'), PosixPath('1;/usr/bin'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/bin'), PosixPath('2'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/sbin'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/bin'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/bin'), PosixPath('1;/usr/sbin'), PosixPath('1;/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/google-cloud-sdk/bin'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/bin'), PosixPath('2;/storage/homefs/st20f757/bin'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/bin'), PosixPath('2;/usr/local/bin'), PosixPath('1;/usr/lpp/mmfs/bin'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/lmod/lmod/libexec'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/sbin'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/bin'), PosixPath('1;/storage/homefs/st20f757/.local/bin'), PosixPath('2;/opt/puppetlabs/bin'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/bin'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/bin')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('+/usr/share/gnudatalanguage')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include/libxml2'), PosixPath('1'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/include/flexiblas'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/include'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/include'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/lib64'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib/pkgconfig'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/zlib/1.2.11/lib/pkgconfig')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share/man'), PosixPath('1'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/man'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share/man'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share/man'), PosixPath('1;/opt/puppetlabs/puppet/share/man'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/zlib/1.2.11/share/man'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share/man')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('() {  eval $($LMOD_DIR/ml_cmd "$@")\n}')}
  warn(msg)
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/usr/local/cuda/lib64')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: No libcudart.so found! Install CUDA or the cudatoolkit package (anaconda)!
  warn(msg)
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cpu.so...
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 2,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'daryl149/llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': True,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.weight', 'classifier.bias']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:16<00:16, 16.53s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:22<00:00, 10.15s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:22<00:00, 11.10s/it]
Loading LLAMA Done
[rank: 0] Global seed set to 42
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]

  | Name           | Type             | Params
----------------------------------------------------
0 | visual_encoder | SwinModel        | 86.7 M
1 | llama_model    | LlamaForCausalLM | 6.7 B 
2 | embed_tokens   | Embedding        | 131 M 
3 | llama_proj     | Linear           | 4.2 M 
4 | layer_norm     | LayerNorm        | 8.2 K 
----------------------------------------------------
4.2 M     Trainable params
6.8 B     Non-trainable params
6.8 B     Total params
27,317.462Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Sanity Checking: 0it [00:00, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py:318: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 40, in train
    trainer.fit(model, datamodule=dm)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 529, in fit
    call._call_and_handle_interrupt(
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 41, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/strategies/launchers/subprocess_script.py", line 91, in launch
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 568, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 973, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1014, in _run_stage
    self._run_sanity_check()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1043, in _run_sanity_check
    val_loop.run()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 291, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/strategies/ddp.py", line 336, in validation_step
    return self.model(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1156, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1110, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])  # type: ignore[index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/overrides/base.py", line 102, in forward
    return self._forward_module.validation_step(*inputs, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 249, in validation_step
    outputs = self.llama_model.generate(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/generation/utils.py", line 1611, in generate
    return self.beam_search(
           ^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/generation/utils.py", line 2909, in beam_search
    outputs = self(
              ^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 688, in forward
    outputs = self.model(
              ^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 578, in forward
    layer_outputs = decoder_layer(
                    ^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 289, in forward
    hidden_states = self.input_layernorm(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 88, in forward
    return (self.weight * hidden_states).to(input_dtype)
            ~~~~~~~~~~~~^~~~~~~~~~~~~~~
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cuda:1!
                                                                   
===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /storage/homefs/st20f757/.conda/envs/rw did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /software.el7/software/zlib/1.2.11/lib:/software.el7/software/HDF5/1.12.1-gompi-2021a/lib:/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib:/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib:/software.el7/software/FFTW/3.3.9-gompi-2021a/lib:/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib:/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib:/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib:/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib:/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib:/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib:/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib:/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib:/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib:/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib:/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib:/software.el7/software/GCCcore/10.3.0/lib64 did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share'), PosixPath('1;/usr/local/share'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share'), PosixPath('1'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share'), PosixPath('1;/var/lib/flatpak/exports/share'), PosixPath('1;/storage/homefs/st20f757/.local/share/flatpak/exports/share'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share'), PosixPath('1;/usr/share'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a'), PosixPath('1;/software.el7/software/GCCcore/10.3.0'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0'), PosixPath('1'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('GCCcore/10.3.0'), PosixPath('1;Anaconda3/2021.11-foss-2021a'), PosixPath('1;Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('1;XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('1;gompi/2021a'), PosixPath('1;ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;FFTW/3.3.9-gompi-2021a'), PosixPath('1;libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;foss/2021a'), PosixPath('1;GCC/10.3.0'), PosixPath('1;numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1'), PosixPath('1;OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('1;libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('1;HDF5/1.12.1-gompi-2021a'), PosixPath('1;OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('1;zlib/.1.2.11')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/modulefiles/all/zlib/.1.2.11.lua'), PosixPath('1;/software.el7/modulefiles/all/FFTW/3.3.9-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/XZ/.5.2.5-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libfabric/1.12.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/foss/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/libxml2/.2.9.10-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/Anaconda3/2021.11-foss-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/UCX/1.10.0-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/hwloc/2.4.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/binutils/.2.36.1-GCCcore-10.3.0.lua'), PosixPath('1'), PosixPath('1;/software.el7/modulefiles/all/OpenBLAS/0.3.15-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/ScaLAPACK/2.1.0-gompi-2021a-fb.lua'), PosixPath('1;/software.el7/modulefiles/all/numactl/2.0.14-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/HDF5/1.12.1-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/FlexiBLAS/3.0.4-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libpciaccess/.0.16-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/Szip/.2.1.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenMPI/4.1.1-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/GCC/10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/gompi/2021a.lua')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('GCCcore/10.3.0'), PosixPath('numactl/2.0.14-GCCcore-10.3.0'), PosixPath('GCC/10.3.0'), PosixPath('FFTW/3.3.9-gompi-2021a'), PosixPath('Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('gompi/2021a'), PosixPath('foss/2021a'), PosixPath('Anaconda3/2021.11-foss-2021a'), PosixPath('XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('HDF5/1.12.1-gompi-2021a'), PosixPath('ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('UCX/1.10.0-GCCcore-10.3.0'), PosixPath('zlib/.1.2.11')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/GCCcore/10.3.0/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/sbin'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/bin'), PosixPath('2;/storage/homefs/st20f757/bin'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/bin'), PosixPath('1;/usr/local/sbin'), PosixPath('1;/usr/lpp/mmfs/bin'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/bin'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/bin'), PosixPath('1;/usr/bin'), PosixPath('1;/software.el7/lmod/lmod/libexec'), PosixPath('1;/storage/homefs/st20f757/.local/bin'), PosixPath('2;/usr/local/bin'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/sbin'), PosixPath('2'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/bin'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/bin'), PosixPath('1;/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/google-cloud-sdk/bin'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/bin'), PosixPath('2;/opt/puppetlabs/bin'), PosixPath('1;/usr/sbin')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('+/usr/share/gnudatalanguage')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include/libxml2'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/include'), PosixPath('1'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/include'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/include/flexiblas'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/include'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/include')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/lib64'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib/pkgconfig'), PosixPath('1;/software.el7/software/zlib/1.2.11/lib/pkgconfig')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share/man'), PosixPath('1'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share/man'), PosixPath('1;/opt/puppetlabs/puppet/share/man'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share/man'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/man'), PosixPath('1;/software.el7/software/zlib/1.2.11/share/man'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share/man')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('() {  eval $($LMOD_DIR/ml_cmd "$@")\n}')}
  warn(msg)
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/usr/local/cuda/lib64')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: No libcudart.so found! Install CUDA or the cudatoolkit package (anaconda)!
  warn(msg)
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cpu.so...
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 2,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'daryl149/llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': True,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.bias', 'classifier.weight']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:17<00:17, 17.05s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:22<00:00, 10.37s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:22<00:00, 11.38s/it]
Loading LLAMA Done
[rank: 0] Global seed set to 42
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]

  | Name           | Type             | Params
----------------------------------------------------
0 | visual_encoder | SwinModel        | 86.7 M
1 | llama_model    | LlamaForCausalLM | 6.7 B 
2 | embed_tokens   | Embedding        | 131 M 
3 | llama_proj     | Linear           | 4.2 M 
4 | layer_norm     | LayerNorm        | 8.2 K 
----------------------------------------------------
4.2 M     Trainable params
6.8 B     Non-trainable params
6.8 B     Total params
27,317.462Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Sanity Checking: 0it [00:00, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 40, in train
    trainer.fit(model, datamodule=dm)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 529, in fit
    call._call_and_handle_interrupt(
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 41, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/strategies/launchers/subprocess_script.py", line 91, in launch
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 568, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 973, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1014, in _run_stage
    self._run_sanity_check()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1043, in _run_sanity_check
    val_loop.run()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 291, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/strategies/ddp.py", line 336, in validation_step
    return self.model(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1156, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1110, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])  # type: ignore[index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/overrides/base.py", line 102, in forward
    return self._forward_module.validation_step(*inputs, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 249, in validation_step
    outputs = self.llama_model.generate(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/generation/utils.py", line 1611, in generate
    return self.beam_search(
           ^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/generation/utils.py", line 2909, in beam_search
    outputs = self(
              ^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 688, in forward
    outputs = self.model(
              ^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 578, in forward
    layer_outputs = decoder_layer(
                    ^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 289, in forward
    hidden_states = self.input_layernorm(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 88, in forward
    return (self.weight * hidden_states).to(input_dtype)
            ~~~~~~~~~~~~^~~~~~~~~~~~~~~
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cuda:1!
                                                                   
===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /storage/homefs/st20f757/.conda/envs/rw did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /software.el7/software/zlib/1.2.11/lib:/software.el7/software/HDF5/1.12.1-gompi-2021a/lib:/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib:/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib:/software.el7/software/FFTW/3.3.9-gompi-2021a/lib:/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib:/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib:/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib:/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib:/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib:/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib:/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib:/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib:/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib:/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib:/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib:/software.el7/software/GCCcore/10.3.0/lib64 did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share'), PosixPath('1;/storage/homefs/st20f757/.local/share/flatpak/exports/share'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share'), PosixPath('1;/var/lib/flatpak/exports/share'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share'), PosixPath('1'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share'), PosixPath('1;/usr/local/share'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/share'), PosixPath('1;/usr/share'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/GCCcore/10.3.0'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0'), PosixPath('1'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('1;numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;FFTW/3.3.9-gompi-2021a'), PosixPath('1;Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('1;zlib/.1.2.11'), PosixPath('1;foss/2021a'), PosixPath('1;hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;Anaconda3/2021.11-foss-2021a'), PosixPath('1'), PosixPath('1;binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('1;libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('1;libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('1;ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;gompi/2021a'), PosixPath('1;GCC/10.3.0'), PosixPath('1;FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('GCCcore/10.3.0'), PosixPath('1;OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;HDF5/1.12.1-gompi-2021a')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/modulefiles/all/OpenMPI/4.1.1-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libpciaccess/.0.16-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/HDF5/1.12.1-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/zlib/.1.2.11.lua'), PosixPath('1;/software.el7/modulefiles/all/Anaconda3/2021.11-foss-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/ScaLAPACK/2.1.0-gompi-2021a-fb.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenBLAS/0.3.15-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/binutils/.2.36.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libxml2/.2.9.10-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/GCC/10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/numactl/2.0.14-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/FFTW/3.3.9-gompi-2021a.lua'), PosixPath('1'), PosixPath('1;/software.el7/modulefiles/all/FlexiBLAS/3.0.4-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/gompi/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/foss/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/UCX/1.10.0-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/hwloc/2.4.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libfabric/1.12.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/XZ/.5.2.5-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/Szip/.2.1.1-GCCcore-10.3.0.lua')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('UCX/1.10.0-GCCcore-10.3.0'), PosixPath('binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('Anaconda3/2021.11-foss-2021a'), PosixPath('zlib/.1.2.11'), PosixPath('gompi/2021a'), PosixPath('libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('GCC/10.3.0'), PosixPath('foss/2021a'), PosixPath('libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('HDF5/1.12.1-gompi-2021a'), PosixPath('numactl/2.0.14-GCCcore-10.3.0'), PosixPath('libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('FFTW/3.3.9-gompi-2021a'), PosixPath('GCCcore/10.3.0'), PosixPath('OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('Szip/.2.1.1-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/bin'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/bin'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/bin'), PosixPath('2;/usr/local/bin'), PosixPath('1;/storage/homefs/st20f757/.local/bin'), PosixPath('2;/storage/homefs/st20f757/bin'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/bin'), PosixPath('1;/software.el7/lmod/lmod/libexec'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/bin'), PosixPath('2'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/bin'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/bin'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/bin'), PosixPath('1;/usr/bin'), PosixPath('1;/usr/local/sbin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/bin'), PosixPath('1;/usr/sbin'), PosixPath('2;/opt/puppetlabs/bin'), PosixPath('1;/usr/lpp/mmfs/bin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/sbin'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/sbin'), PosixPath('1;/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/google-cloud-sdk/bin')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('+/usr/share/gnudatalanguage')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/include'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/include/flexiblas'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include/libxml2'), PosixPath('1'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/include'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/include')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/lib64'), PosixPath('1'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib/pkgconfig'), PosixPath('1;/software.el7/software/zlib/1.2.11/lib/pkgconfig'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib/pkgconfig')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share/man'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/man'), PosixPath('1'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share/man'), PosixPath('1;/opt/puppetlabs/puppet/share/man'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/zlib/1.2.11/share/man'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share/man')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('() {  eval $($LMOD_DIR/ml_cmd "$@")\n}')}
  warn(msg)
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/usr/local/cuda/lib64')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: No libcudart.so found! Install CUDA or the cudatoolkit package (anaconda)!
  warn(msg)
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cpu.so...
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 1,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'daryl149/llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': True,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.weight', 'classifier.bias']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:18<00:18, 18.67s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:24<00:00, 11.22s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:24<00:00, 12.34s/it]
Loading LLAMA Done
[rank: 0] Global seed set to 42
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name           | Type             | Params
----------------------------------------------------
0 | visual_encoder | SwinModel        | 86.7 M
1 | llama_model    | LlamaForCausalLM | 6.7 B 
2 | embed_tokens   | Embedding        | 131 M 
3 | llama_proj     | Linear           | 4.2 M 
4 | layer_norm     | LayerNorm        | 8.2 K 
----------------------------------------------------
4.2 M     Trainable params
6.8 B     Non-trainable params
6.8 B     Total params
27,317.462Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Sanity Checking: 0it [00:00, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py:318: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 40, in train
    trainer.fit(model, datamodule=dm)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 529, in fit
    call._call_and_handle_interrupt(
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 41, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/strategies/launchers/subprocess_script.py", line 91, in launch
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 568, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 973, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1014, in _run_stage
    self._run_sanity_check()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1043, in _run_sanity_check
    val_loop.run()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 291, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/strategies/ddp.py", line 336, in validation_step
    return self.model(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1156, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1110, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])  # type: ignore[index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/overrides/base.py", line 102, in forward
    return self._forward_module.validation_step(*inputs, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 249, in validation_step
    outputs = self.llama_model.generate(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/generation/utils.py", line 1611, in generate
    return self.beam_search(
           ^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/generation/utils.py", line 2909, in beam_search
    outputs = self(
              ^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 688, in forward
    outputs = self.model(
              ^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 578, in forward
    layer_outputs = decoder_layer(
                    ^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 292, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
                                                          ^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 208, in forward
    value_states = torch.cat([past_key_value[1], value_states], dim=2)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 70.00 MiB (GPU 0; 23.70 GiB total capacity; 19.87 GiB already allocated; 56.69 MiB free; 22.26 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
                                                                   
===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /storage/homefs/st20f757/.conda/envs/rw did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /software.el7/software/zlib/1.2.11/lib:/software.el7/software/HDF5/1.12.1-gompi-2021a/lib:/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib:/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib:/software.el7/software/FFTW/3.3.9-gompi-2021a/lib:/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib:/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib:/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib:/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib:/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib:/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib:/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib:/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib:/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib:/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib:/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib:/software.el7/software/GCCcore/10.3.0/lib64 did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/GCCcore/10.3.0/share'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share'), PosixPath('1;/var/lib/flatpak/exports/share'), PosixPath('1;/usr/share'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share'), PosixPath('1'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/share'), PosixPath('1;/storage/homefs/st20f757/.local/share/flatpak/exports/share'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share'), PosixPath('1;/usr/local/share')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;/software.el7/software/GCCcore/10.3.0'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('GCCcore/10.3.0'), PosixPath('1;libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;GCC/10.3.0'), PosixPath('1'), PosixPath('1;gompi/2021a'), PosixPath('1;FFTW/3.3.9-gompi-2021a'), PosixPath('1;OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('1;zlib/.1.2.11'), PosixPath('1;numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;foss/2021a'), PosixPath('1;hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('1;ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('1;Anaconda3/2021.11-foss-2021a'), PosixPath('1;FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;HDF5/1.12.1-gompi-2021a'), PosixPath('1;binutils/.2.36.1-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/modulefiles/all/ScaLAPACK/2.1.0-gompi-2021a-fb.lua'), PosixPath('1'), PosixPath('1;/software.el7/modulefiles/all/OpenMPI/4.1.1-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libxml2/.2.9.10-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/gompi/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/binutils/.2.36.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/foss/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/FlexiBLAS/3.0.4-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/UCX/1.10.0-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/XZ/.5.2.5-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/Szip/.2.1.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libpciaccess/.0.16-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/zlib/.1.2.11.lua'), PosixPath('1;/software.el7/modulefiles/all/hwloc/2.4.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libfabric/1.12.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/FFTW/3.3.9-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/GCC/10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/Anaconda3/2021.11-foss-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/HDF5/1.12.1-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/numactl/2.0.14-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenBLAS/0.3.15-GCC-10.3.0.lua')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('FFTW/3.3.9-gompi-2021a'), PosixPath('GCCcore/10.3.0'), PosixPath('OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('numactl/2.0.14-GCCcore-10.3.0'), PosixPath('XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('GCC/10.3.0'), PosixPath('libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('Anaconda3/2021.11-foss-2021a'), PosixPath('binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('zlib/.1.2.11'), PosixPath('UCX/1.10.0-GCCcore-10.3.0'), PosixPath('FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('gompi/2021a'), PosixPath('Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('foss/2021a'), PosixPath('HDF5/1.12.1-gompi-2021a'), PosixPath('hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('ScaLAPACK/2.1.0-gompi-2021a-fb')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/bin'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/sbin'), PosixPath('2;/usr/local/bin'), PosixPath('1;/usr/sbin'), PosixPath('1;/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/google-cloud-sdk/bin'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/bin'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/bin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/sbin'), PosixPath('1;/software.el7/lmod/lmod/libexec'), PosixPath('1;/storage/homefs/st20f757/.local/bin'), PosixPath('2;/storage/homefs/st20f757/bin'), PosixPath('2'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/bin'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/bin'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/bin'), PosixPath('1;/usr/bin'), PosixPath('1;/usr/local/sbin'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/bin'), PosixPath('2;/opt/puppetlabs/bin'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/bin'), PosixPath('1;/usr/lpp/mmfs/bin'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/bin')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('+/usr/share/gnudatalanguage')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/include'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/include'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/include/flexiblas'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include/libxml2'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/include')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/lib64'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib/pkgconfig'), PosixPath('1'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/zlib/1.2.11/lib/pkgconfig'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib/pkgconfig'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib/pkgconfig')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share/man'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share/man'), PosixPath('1;/opt/puppetlabs/puppet/share/man'), PosixPath('1'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share/man'), PosixPath('1;/software.el7/software/zlib/1.2.11/share/man'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/man')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('() {  eval $($LMOD_DIR/ml_cmd "$@")\n}')}
  warn(msg)
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/usr/local/cuda/lib64')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: No libcudart.so found! Install CUDA or the cudatoolkit package (anaconda)!
  warn(msg)
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cpu.so...
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 2,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'daryl149/llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': True,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.weight', 'classifier.bias']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:18<00:18, 18.25s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:25<00:00, 11.58s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:25<00:00, 12.58s/it]
Loading LLAMA Done
[rank: 0] Global seed set to 42
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]

  | Name           | Type             | Params
----------------------------------------------------
0 | visual_encoder | SwinModel        | 86.7 M
1 | llama_model    | LlamaForCausalLM | 6.7 B 
2 | embed_tokens   | Embedding        | 131 M 
3 | llama_proj     | Linear           | 4.2 M 
4 | layer_norm     | LayerNorm        | 8.2 K 
----------------------------------------------------
4.2 M     Trainable params
6.8 B     Non-trainable params
6.8 B     Total params
27,317.462Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Sanity Checking: 0it [00:00, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py:318: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 40, in train
    trainer.fit(model, datamodule=dm)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 529, in fit
    call._call_and_handle_interrupt(
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 41, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/strategies/launchers/subprocess_script.py", line 91, in launch
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 568, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 973, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1014, in _run_stage
    self._run_sanity_check()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1043, in _run_sanity_check
    val_loop.run()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 291, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/strategies/ddp.py", line 336, in validation_step
    return self.model(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1156, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1110, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])  # type: ignore[index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/pytorch/overrides/base.py", line 102, in forward
    return self._forward_module.validation_step(*inputs, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 249, in validation_step
    outputs = self.llama_model.generate(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/generation/utils.py", line 1611, in generate
    return self.beam_search(
           ^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/generation/utils.py", line 2909, in beam_search
    outputs = self(
              ^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 688, in forward
    outputs = self.model(
              ^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 578, in forward
    layer_outputs = decoder_layer(
                    ^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 289, in forward
    hidden_states = self.input_layernorm(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 88, in forward
    return (self.weight * hidden_states).to(input_dtype)
            ~~~~~~~~~~~~^~~~~~~~~~~~~~~
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cuda:1!
                                                                   
===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /storage/homefs/st20f757/.conda/envs/rw did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /software.el7/software/zlib/1.2.11/lib:/software.el7/software/HDF5/1.12.1-gompi-2021a/lib:/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib:/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib:/software.el7/software/FFTW/3.3.9-gompi-2021a/lib:/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib:/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib:/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib:/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib:/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib:/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib:/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib:/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib:/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib:/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib:/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib:/software.el7/software/GCCcore/10.3.0/lib64 did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share'), PosixPath('1;/storage/homefs/st20f757/.local/share/flatpak/exports/share'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share'), PosixPath('1;/var/lib/flatpak/exports/share'), PosixPath('1;/usr/share'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share'), PosixPath('1;/usr/local/share'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share'), PosixPath('1'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/GCCcore/10.3.0'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0'), PosixPath('1'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;Anaconda3/2021.11-foss-2021a'), PosixPath('1;numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1'), PosixPath('1;ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;FFTW/3.3.9-gompi-2021a'), PosixPath('1;libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('GCCcore/10.3.0'), PosixPath('1;Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('1;OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;zlib/.1.2.11'), PosixPath('1;GCC/10.3.0'), PosixPath('1;gompi/2021a'), PosixPath('1;XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('1;FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;foss/2021a'), PosixPath('1;libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('1;HDF5/1.12.1-gompi-2021a'), PosixPath('1;libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;binutils/.2.36.1-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/modulefiles/all/numactl/2.0.14-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/Szip/.2.1.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/XZ/.5.2.5-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libxml2/.2.9.10-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/FlexiBLAS/3.0.4-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/FFTW/3.3.9-gompi-2021a.lua'), PosixPath('1'), PosixPath('1;/software.el7/modulefiles/all/zlib/.1.2.11.lua'), PosixPath('1;/software.el7/modulefiles/all/Anaconda3/2021.11-foss-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/libpciaccess/.0.16-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/HDF5/1.12.1-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/gompi/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenMPI/4.1.1-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/ScaLAPACK/2.1.0-gompi-2021a-fb.lua'), PosixPath('1;/software.el7/modulefiles/all/binutils/.2.36.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/foss/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenBLAS/0.3.15-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libfabric/1.12.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/GCC/10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/hwloc/2.4.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/UCX/1.10.0-GCCcore-10.3.0.lua')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('UCX/1.10.0-GCCcore-10.3.0'), PosixPath('ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('gompi/2021a'), PosixPath('FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('foss/2021a'), PosixPath('GCCcore/10.3.0'), PosixPath('numactl/2.0.14-GCCcore-10.3.0'), PosixPath('Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('GCC/10.3.0'), PosixPath('libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('FFTW/3.3.9-gompi-2021a'), PosixPath('zlib/.1.2.11'), PosixPath('HDF5/1.12.1-gompi-2021a'), PosixPath('Anaconda3/2021.11-foss-2021a'), PosixPath('libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('XZ/.5.2.5-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('2;/usr/local/bin'), PosixPath('1;/usr/local/sbin'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/bin'), PosixPath('1;/usr/sbin'), PosixPath('2;/storage/homefs/st20f757/bin'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/bin'), PosixPath('1;/software.el7/lmod/lmod/libexec'), PosixPath('1;/storage/homefs/st20f757/.local/bin'), PosixPath('2;/opt/puppetlabs/bin'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/sbin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/bin'), PosixPath('2'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/sbin'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/bin'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/bin'), PosixPath('1;/usr/bin'), PosixPath('1;/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/google-cloud-sdk/bin'), PosixPath('1;/usr/lpp/mmfs/bin'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/bin')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('+/usr/share/gnudatalanguage')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include/libxml2'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/include/flexiblas'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/include'), PosixPath('1'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/include'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/include')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/lib64'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1'), PosixPath('1;/software.el7/software/zlib/1.2.11/lib/pkgconfig'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib/pkgconfig'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib/pkgconfig')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share/man'), PosixPath('1;/opt/puppetlabs/puppet/share/man'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share/man'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/zlib/1.2.11/share/man'), PosixPath('1'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/man'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share/man')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('() {  eval $($LMOD_DIR/ml_cmd "$@")\n}')}
  warn(msg)
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/usr/local/cuda/lib64')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: No libcudart.so found! Install CUDA or the cudatoolkit package (anaconda)!
  warn(msg)
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cpu.so...
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 2,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'meta-llama/Llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': True,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.bias', 'classifier.weight']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Traceback (most recent call last):
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_errors.py", line 261, in hf_raise_for_status
    response.raise_for_status()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://huggingface.co/meta-llama/Llama-2-7b-chat-hf/resolve/main/tokenizer.model

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/utils/hub.py", line 417, in cached_file
    resolved_file = hf_hub_download(
                    ^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1346, in hf_hub_download
    raise head_call_error
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1232, in hf_hub_download
    metadata = get_hf_file_metadata(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1608, in get_hf_file_metadata
    hf_raise_for_status(r)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_errors.py", line 277, in hf_raise_for_status
    raise GatedRepoError(message, response) from e
huggingface_hub.utils._errors.GatedRepoError: 401 Client Error. (Request ID: Root=1-6512c464-2a54d4b91d5e15d866c7603e;ef1d3b13-ce14-492d-a79c-fac09b88f9bf)

Cannot access gated repo for url https://huggingface.co/meta-llama/Llama-2-7b-chat-hf/resolve/main/tokenizer.model.
Repo model meta-llama/Llama-2-7b-chat-hf is gated. You must be authenticated to access it.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 33, in train
    model = R2GenGPT(args)
            ^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 49, in __init__
    self.llama_tokenizer = LlamaTokenizer.from_pretrained(args.llama_model, use_fast=False)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 1784, in from_pretrained
    resolved_vocab_files[file_id] = cached_file(
                                    ^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/utils/hub.py", line 433, in cached_file
    raise EnvironmentError(
OSError: meta-llama/Llama-2-7b-chat-hf is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo with `use_auth_token` or log in with `huggingface-cli login` and pass `use_auth_token=True`.

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /storage/homefs/st20f757/.conda/envs/rw did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /software.el7/software/zlib/1.2.11/lib:/software.el7/software/HDF5/1.12.1-gompi-2021a/lib:/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib:/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib:/software.el7/software/FFTW/3.3.9-gompi-2021a/lib:/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib:/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib:/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib:/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib:/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib:/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib:/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib:/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib:/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib:/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib:/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib:/software.el7/software/GCCcore/10.3.0/lib64 did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share'), PosixPath('1;/var/lib/flatpak/exports/share'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share'), PosixPath('1;/usr/share'), PosixPath('1'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share'), PosixPath('1;/usr/local/share'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/share'), PosixPath('1;/storage/homefs/st20f757/.local/share/flatpak/exports/share')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;/software.el7/software/GCCcore/10.3.0'), PosixPath('1'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('1;HDF5/1.12.1-gompi-2021a'), PosixPath('1;ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('1;FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;gompi/2021a'), PosixPath('1;Anaconda3/2021.11-foss-2021a'), PosixPath('1;hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1'), PosixPath('1;UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('1;zlib/.1.2.11'), PosixPath('GCCcore/10.3.0'), PosixPath('1;Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('1;GCC/10.3.0'), PosixPath('1;libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('1;foss/2021a'), PosixPath('1;FFTW/3.3.9-gompi-2021a')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/modulefiles/all/numactl/2.0.14-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libpciaccess/.0.16-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libxml2/.2.9.10-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenBLAS/0.3.15-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/foss/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/Anaconda3/2021.11-foss-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/FlexiBLAS/3.0.4-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/XZ/.5.2.5-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/FFTW/3.3.9-gompi-2021a.lua'), PosixPath('1'), PosixPath('1;/software.el7/modulefiles/all/HDF5/1.12.1-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/UCX/1.10.0-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/Szip/.2.1.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/hwloc/2.4.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/gompi/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/binutils/.2.36.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libfabric/1.12.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/GCC/10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/ScaLAPACK/2.1.0-gompi-2021a-fb.lua'), PosixPath('1;/software.el7/modulefiles/all/zlib/.1.2.11.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenMPI/4.1.1-GCC-10.3.0.lua')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('zlib/.1.2.11'), PosixPath('libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('HDF5/1.12.1-gompi-2021a'), PosixPath('gompi/2021a'), PosixPath('OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('GCCcore/10.3.0'), PosixPath('Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('GCC/10.3.0'), PosixPath('numactl/2.0.14-GCCcore-10.3.0'), PosixPath('libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('Anaconda3/2021.11-foss-2021a'), PosixPath('UCX/1.10.0-GCCcore-10.3.0'), PosixPath('foss/2021a'), PosixPath('XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('FFTW/3.3.9-gompi-2021a')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/lmod/lmod/libexec'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/bin'), PosixPath('2;/storage/homefs/st20f757/bin'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/bin'), PosixPath('1;/usr/sbin'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/bin'), PosixPath('2'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/sbin'), PosixPath('2;/opt/puppetlabs/bin'), PosixPath('2;/usr/local/bin'), PosixPath('1;/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/google-cloud-sdk/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/sbin'), PosixPath('1;/usr/lpp/mmfs/bin'), PosixPath('1;/usr/local/sbin'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/bin'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/bin'), PosixPath('1;/usr/bin'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/bin'), PosixPath('1;/storage/homefs/st20f757/.local/bin'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/bin'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/bin')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('+/usr/share/gnudatalanguage')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/include'), PosixPath('1'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/include'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/include/flexiblas'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include/libxml2'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/include')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/lib64'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/zlib/1.2.11/lib/pkgconfig'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib/pkgconfig'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib/pkgconfig')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/man'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share/man'), PosixPath('1'), PosixPath('1;/opt/puppetlabs/puppet/share/man'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share/man'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share/man'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/zlib/1.2.11/share/man')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('() {  eval $($LMOD_DIR/ml_cmd "$@")\n}')}
  warn(msg)
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/usr/local/cuda/lib64')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: No libcudart.so found! Install CUDA or the cudatoolkit package (anaconda)!
  warn(msg)
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cpu.so...
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 2,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': '/storage/workspaces/artorg_aimi/ws_00000/sergio/llama/Llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': True,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.weight', 'classifier.bias']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 33, in train
    model = R2GenGPT(args)
            ^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 49, in __init__
    self.llama_tokenizer = LlamaTokenizer.from_pretrained(args.llama_model, use_fast=False)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 1825, in from_pretrained
    return cls._from_pretrained(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 1988, in _from_pretrained
    tokenizer = cls(*init_inputs, **init_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/models/llama/tokenization_llama.py", line 96, in __init__
    self.sp_model.Load(vocab_file)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/sentencepiece/__init__.py", line 905, in Load
    return self.LoadFromFile(model_file)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/sentencepiece/__init__.py", line 310, in LoadFromFile
    return _sentencepiece.SentencePieceProcessor_LoadFromFile(self, arg)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Internal: src/sentencepiece_processor.cc(1101) [model_proto->ParseFromArray(serialized.data(), serialized.size())] 

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /storage/homefs/st20f757/.conda/envs/rw did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /software.el7/software/zlib/1.2.11/lib:/software.el7/software/HDF5/1.12.1-gompi-2021a/lib:/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib:/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib:/software.el7/software/FFTW/3.3.9-gompi-2021a/lib:/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib:/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib:/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib:/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib:/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib:/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib:/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib:/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib:/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib:/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib:/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib:/software.el7/software/GCCcore/10.3.0/lib64 did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/storage/homefs/st20f757/.local/share/flatpak/exports/share'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/share'), PosixPath('1;/usr/share'), PosixPath('1'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share'), PosixPath('1;/usr/local/share'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share'), PosixPath('1;/var/lib/flatpak/exports/share')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/GCCcore/10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;HDF5/1.12.1-gompi-2021a'), PosixPath('1;GCC/10.3.0'), PosixPath('1;numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;FFTW/3.3.9-gompi-2021a'), PosixPath('1;UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('GCCcore/10.3.0'), PosixPath('1;ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1'), PosixPath('1;Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('1;zlib/.1.2.11'), PosixPath('1;libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('1;hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('1;foss/2021a'), PosixPath('1;gompi/2021a'), PosixPath('1;OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('1;Anaconda3/2021.11-foss-2021a')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/modulefiles/all/foss/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/UCX/1.10.0-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/zlib/.1.2.11.lua'), PosixPath('1'), PosixPath('1;/software.el7/modulefiles/all/libpciaccess/.0.16-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/binutils/.2.36.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenBLAS/0.3.15-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/ScaLAPACK/2.1.0-gompi-2021a-fb.lua'), PosixPath('1;/software.el7/modulefiles/all/GCC/10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/gompi/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/hwloc/2.4.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/XZ/.5.2.5-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libfabric/1.12.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/numactl/2.0.14-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libxml2/.2.9.10-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/FFTW/3.3.9-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/Anaconda3/2021.11-foss-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenMPI/4.1.1-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/FlexiBLAS/3.0.4-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/Szip/.2.1.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/HDF5/1.12.1-gompi-2021a.lua')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('gompi/2021a'), PosixPath('numactl/2.0.14-GCCcore-10.3.0'), PosixPath('libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('GCCcore/10.3.0'), PosixPath('libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('Anaconda3/2021.11-foss-2021a'), PosixPath('GCC/10.3.0'), PosixPath('OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('FFTW/3.3.9-gompi-2021a'), PosixPath('ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('HDF5/1.12.1-gompi-2021a'), PosixPath('foss/2021a'), PosixPath('zlib/.1.2.11'), PosixPath('UCX/1.10.0-GCCcore-10.3.0'), PosixPath('hwloc/2.4.1-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/bin'), PosixPath('1;/usr/lpp/mmfs/bin'), PosixPath('1;/usr/bin'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/sbin'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/lmod/lmod/libexec'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/bin'), PosixPath('2;/opt/puppetlabs/bin'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/bin'), PosixPath('1;/usr/sbin'), PosixPath('2;/storage/homefs/st20f757/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/bin'), PosixPath('2'), PosixPath('2;/usr/local/bin'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/bin'), PosixPath('1;/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/google-cloud-sdk/bin'), PosixPath('1;/storage/homefs/st20f757/.local/bin'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/bin'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/bin'), PosixPath('1;/usr/local/sbin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/sbin'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/bin')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('+/usr/share/gnudatalanguage')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include/libxml2'), PosixPath('1'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/include'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/include/flexiblas'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/include'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/include')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/lib64'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib/pkgconfig'), PosixPath('1'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/zlib/1.2.11/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib/pkgconfig')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/zlib/1.2.11/share/man'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share/man'), PosixPath('1'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/man'), PosixPath('1;/opt/puppetlabs/puppet/share/man'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share/man'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share/man')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('() {  eval $($LMOD_DIR/ml_cmd "$@")\n}')}
  warn(msg)
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/usr/local/cuda/lib64')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: No libcudart.so found! Install CUDA or the cudatoolkit package (anaconda)!
  warn(msg)
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cpu.so...
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 2,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'meta-llama/Llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': True,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.weight', 'classifier.bias']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Traceback (most recent call last):
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_errors.py", line 261, in hf_raise_for_status
    response.raise_for_status()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://huggingface.co/meta-llama/Llama-2-7b-chat-hf/resolve/main/tokenizer.model

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/utils/hub.py", line 417, in cached_file
    resolved_file = hf_hub_download(
                    ^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1346, in hf_hub_download
    raise head_call_error
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1232, in hf_hub_download
    metadata = get_hf_file_metadata(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1608, in get_hf_file_metadata
    hf_raise_for_status(r)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_errors.py", line 277, in hf_raise_for_status
    raise GatedRepoError(message, response) from e
huggingface_hub.utils._errors.GatedRepoError: 401 Client Error. (Request ID: Root=1-6512cab2-7338a4171958696c6cdb8b97;307dcd21-b297-4466-a33d-cf6b90d33d63)

Cannot access gated repo for url https://huggingface.co/meta-llama/Llama-2-7b-chat-hf/resolve/main/tokenizer.model.
Repo model meta-llama/Llama-2-7b-chat-hf is gated. You must be authenticated to access it.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 33, in train
    model = R2GenGPT(args)
            ^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 49, in __init__
    self.llama_tokenizer = LlamaTokenizer.from_pretrained(args.llama_model, use_fast=False)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 1784, in from_pretrained
    resolved_vocab_files[file_id] = cached_file(
                                    ^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/utils/hub.py", line 433, in cached_file
    raise EnvironmentError(
OSError: meta-llama/Llama-2-7b-chat-hf is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo with `use_auth_token` or log in with `huggingface-cli login` and pass `use_auth_token=True`.

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /storage/homefs/st20f757/.conda/envs/rw did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /software.el7/software/zlib/1.2.11/lib:/software.el7/software/HDF5/1.12.1-gompi-2021a/lib:/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib:/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib:/software.el7/software/FFTW/3.3.9-gompi-2021a/lib:/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib:/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib:/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib:/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib:/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib:/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib:/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib:/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib:/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib:/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib:/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib:/software.el7/software/GCCcore/10.3.0/lib64 did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/GCCcore/10.3.0/share'), PosixPath('1;/usr/local/share'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share'), PosixPath('1;/storage/homefs/st20f757/.local/share/flatpak/exports/share'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share'), PosixPath('1;/var/lib/flatpak/exports/share'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share'), PosixPath('1;/usr/share'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share'), PosixPath('1'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/GCCcore/10.3.0'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0'), PosixPath('1'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('1;FFTW/3.3.9-gompi-2021a'), PosixPath('1;libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('1;GCC/10.3.0'), PosixPath('1;UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;foss/2021a'), PosixPath('1;gompi/2021a'), PosixPath('1;hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;zlib/.1.2.11'), PosixPath('1;FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('GCCcore/10.3.0'), PosixPath('1;XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('1;OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1'), PosixPath('1;HDF5/1.12.1-gompi-2021a'), PosixPath('1;Anaconda3/2021.11-foss-2021a'), PosixPath('1;libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('1;OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;ScaLAPACK/2.1.0-gompi-2021a-fb')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/modulefiles/all/UCX/1.10.0-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libfabric/1.12.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/hwloc/2.4.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/XZ/.5.2.5-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/Szip/.2.1.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/ScaLAPACK/2.1.0-gompi-2021a-fb.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenBLAS/0.3.15-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/zlib/.1.2.11.lua'), PosixPath('1;/software.el7/modulefiles/all/gompi/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/numactl/2.0.14-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/GCC/10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/HDF5/1.12.1-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/FFTW/3.3.9-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/foss/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/binutils/.2.36.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libxml2/.2.9.10-GCCcore-10.3.0.lua'), PosixPath('1'), PosixPath('1;/software.el7/modulefiles/all/Anaconda3/2021.11-foss-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/FlexiBLAS/3.0.4-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenMPI/4.1.1-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libpciaccess/.0.16-GCCcore-10.3.0.lua')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('GCC/10.3.0'), PosixPath('zlib/.1.2.11'), PosixPath('OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('foss/2021a'), PosixPath('XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('FFTW/3.3.9-gompi-2021a'), PosixPath('HDF5/1.12.1-gompi-2021a'), PosixPath('binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('Anaconda3/2021.11-foss-2021a'), PosixPath('numactl/2.0.14-GCCcore-10.3.0'), PosixPath('ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('UCX/1.10.0-GCCcore-10.3.0'), PosixPath('GCCcore/10.3.0'), PosixPath('Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('gompi/2021a')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/bin'), PosixPath('2'), PosixPath('2;/opt/puppetlabs/bin'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/lmod/lmod/libexec'), PosixPath('1;/usr/local/sbin'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/bin'), PosixPath('1;/usr/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/sbin'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/bin'), PosixPath('1;/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/google-cloud-sdk/bin'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/bin'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/bin'), PosixPath('1;/storage/homefs/st20f757/.local/bin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/bin'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/bin'), PosixPath('2;/usr/local/bin'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/bin'), PosixPath('1;/usr/sbin'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/bin'), PosixPath('1;/usr/lpp/mmfs/bin'), PosixPath('2;/storage/homefs/st20f757/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/sbin')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('+/usr/share/gnudatalanguage')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/include/flexiblas'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include/libxml2'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/include'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/include'), PosixPath('1'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/include')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/lib64'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib/pkgconfig'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib/pkgconfig'), PosixPath('1'), PosixPath('1;/software.el7/software/zlib/1.2.11/lib/pkgconfig'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib/pkgconfig')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/zlib/1.2.11/share/man'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share/man'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share/man'), PosixPath('1'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share/man'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share/man'), PosixPath('1;/opt/puppetlabs/puppet/share/man'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/man')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('() {  eval $($LMOD_DIR/ml_cmd "$@")\n}')}
  warn(msg)
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/usr/local/cuda/lib64')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: No libcudart.so found! Install CUDA or the cudatoolkit package (anaconda)!
  warn(msg)
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cpu.so...
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 2,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'meta-llama/Llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': True,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.weight', 'classifier.bias']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Traceback (most recent call last):
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_errors.py", line 261, in hf_raise_for_status
    response.raise_for_status()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://huggingface.co/meta-llama/Llama-2-7b-chat-hf/resolve/main/tokenizer.model

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/utils/hub.py", line 417, in cached_file
    resolved_file = hf_hub_download(
                    ^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1346, in hf_hub_download
    raise head_call_error
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1232, in hf_hub_download
    metadata = get_hf_file_metadata(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1608, in get_hf_file_metadata
    hf_raise_for_status(r)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_errors.py", line 277, in hf_raise_for_status
    raise GatedRepoError(message, response) from e
huggingface_hub.utils._errors.GatedRepoError: 401 Client Error. (Request ID: Root=1-6512cb98-7656d0b226b6f0943203ee1d;2072fbe6-0211-433e-b86b-735332e9a01e)

Cannot access gated repo for url https://huggingface.co/meta-llama/Llama-2-7b-chat-hf/resolve/main/tokenizer.model.
Repo model meta-llama/Llama-2-7b-chat-hf is gated. You must be authenticated to access it.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 33, in train
    model = R2GenGPT(args)
            ^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 49, in __init__
    self.llama_tokenizer = LlamaTokenizer.from_pretrained(args.llama_model, use_fast=False)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 1784, in from_pretrained
    resolved_vocab_files[file_id] = cached_file(
                                    ^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/utils/hub.py", line 433, in cached_file
    raise EnvironmentError(
OSError: meta-llama/Llama-2-7b-chat-hf is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo with `use_auth_token` or log in with `huggingface-cli login` and pass `use_auth_token=True`.

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /storage/homefs/st20f757/.conda/envs/rw did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /software.el7/software/zlib/1.2.11/lib:/software.el7/software/HDF5/1.12.1-gompi-2021a/lib:/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib:/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib:/software.el7/software/FFTW/3.3.9-gompi-2021a/lib:/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib:/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib:/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib:/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib:/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib:/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib:/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib:/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib:/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib:/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib:/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib:/software.el7/software/GCCcore/10.3.0/lib64 did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/share'), PosixPath('1;/storage/homefs/st20f757/.local/share/flatpak/exports/share'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share'), PosixPath('1;/usr/local/share'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share'), PosixPath('1'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share'), PosixPath('1;/usr/share'), PosixPath('1;/var/lib/flatpak/exports/share'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/GCCcore/10.3.0'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0'), PosixPath('1'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;foss/2021a'), PosixPath('1;HDF5/1.12.1-gompi-2021a'), PosixPath('1;Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('1;libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('1;UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;Anaconda3/2021.11-foss-2021a'), PosixPath('1;FFTW/3.3.9-gompi-2021a'), PosixPath('1;hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;gompi/2021a'), PosixPath('1;OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;GCC/10.3.0'), PosixPath('1;XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('GCCcore/10.3.0'), PosixPath('1;binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('1;FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1'), PosixPath('1;zlib/.1.2.11'), PosixPath('1;libxml2/.2.9.10-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/modulefiles/all/libxml2/.2.9.10-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/gompi/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/hwloc/2.4.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/Anaconda3/2021.11-foss-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/HDF5/1.12.1-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/zlib/.1.2.11.lua'), PosixPath('1;/software.el7/modulefiles/all/ScaLAPACK/2.1.0-gompi-2021a-fb.lua'), PosixPath('1;/software.el7/modulefiles/all/libpciaccess/.0.16-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/foss/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenBLAS/0.3.15-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/numactl/2.0.14-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/Szip/.2.1.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/UCX/1.10.0-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenMPI/4.1.1-GCC-10.3.0.lua'), PosixPath('1'), PosixPath('1;/software.el7/modulefiles/all/libfabric/1.12.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/XZ/.5.2.5-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/GCC/10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/binutils/.2.36.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/FlexiBLAS/3.0.4-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/FFTW/3.3.9-gompi-2021a.lua')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('Anaconda3/2021.11-foss-2021a'), PosixPath('OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('FFTW/3.3.9-gompi-2021a'), PosixPath('libxml2/.2.9.10-GCCcore-10.3.0'), PosixPath('foss/2021a'), PosixPath('gompi/2021a'), PosixPath('numactl/2.0.14-GCCcore-10.3.0'), PosixPath('GCC/10.3.0'), PosixPath('ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('HDF5/1.12.1-gompi-2021a'), PosixPath('GCCcore/10.3.0'), PosixPath('zlib/.1.2.11'), PosixPath('OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('UCX/1.10.0-GCCcore-10.3.0'), PosixPath('Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('binutils/.2.36.1-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/lmod/lmod/libexec'), PosixPath('1;/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/google-cloud-sdk/bin'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/bin'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/bin'), PosixPath('1;/usr/bin'), PosixPath('2'), PosixPath('2;/usr/local/bin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/sbin'), PosixPath('1;/storage/homefs/st20f757/.local/bin'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/bin'), PosixPath('1;/usr/local/sbin'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/bin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/bin'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/bin'), PosixPath('1;/usr/lpp/mmfs/bin'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/bin'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/sbin'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/bin'), PosixPath('1;/usr/sbin'), PosixPath('2;/storage/homefs/st20f757/bin'), PosixPath('2;/opt/puppetlabs/bin'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/bin')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('+/usr/share/gnudatalanguage')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/include'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/include'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/include/flexiblas'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include/libxml2'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/include'), PosixPath('1'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/include')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/lib64'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/zlib/1.2.11/lib/pkgconfig'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib/pkgconfig'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib/pkgconfig')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share/man'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/man'), PosixPath('1;/software.el7/software/zlib/1.2.11/share/man'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share/man'), PosixPath('1;/opt/puppetlabs/puppet/share/man'), PosixPath('1'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share/man'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share/man')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('() {  eval $($LMOD_DIR/ml_cmd "$@")\n}')}
  warn(msg)
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/usr/local/cuda/lib64')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: No libcudart.so found! Install CUDA or the cudatoolkit package (anaconda)!
  warn(msg)
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cpu.so...
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 2,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'meta-llama/Llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': True,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.weight', 'classifier.bias']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Traceback (most recent call last):
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_errors.py", line 261, in hf_raise_for_status
    response.raise_for_status()
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://huggingface.co/meta-llama/Llama-2-7b-chat-hf/resolve/main/tokenizer.model

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/utils/hub.py", line 417, in cached_file
    resolved_file = hf_hub_download(
                    ^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1346, in hf_hub_download
    raise head_call_error
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1232, in hf_hub_download
    metadata = get_hf_file_metadata(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1608, in get_hf_file_metadata
    hf_raise_for_status(r)
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/huggingface_hub/utils/_errors.py", line 277, in hf_raise_for_status
    raise GatedRepoError(message, response) from e
huggingface_hub.utils._errors.GatedRepoError: 401 Client Error. (Request ID: Root=1-6512ccae-41ae73c01e8574d27a0f1803;334f72b4-50e1-4b09-9304-d1f85808f713)

Cannot access gated repo for url https://huggingface.co/meta-llama/Llama-2-7b-chat-hf/resolve/main/tokenizer.model.
Repo model meta-llama/Llama-2-7b-chat-hf is gated. You must be authenticated to access it.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 51, in <module>
    main()
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 47, in main
    train(args)
  File "/storage/homefs/st20f757/vqa/ReportWizard/train.py", line 33, in train
    model = R2GenGPT(args)
            ^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/vqa/ReportWizard/models/R2GenGPT.py", line 49, in __init__
    self.llama_tokenizer = LlamaTokenizer.from_pretrained(args.llama_model, use_fast=False)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 1784, in from_pretrained
    resolved_vocab_files[file_id] = cached_file(
                                    ^^^^^^^^^^^^
  File "/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/transformers/utils/hub.py", line 433, in cached_file
    raise EnvironmentError(
OSError: meta-llama/Llama-2-7b-chat-hf is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo with `use_auth_token` or log in with `huggingface-cli login` and pass `use_auth_token=True`.

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /storage/homefs/st20f757/.conda/envs/rw did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: /software.el7/software/zlib/1.2.11/lib:/software.el7/software/HDF5/1.12.1-gompi-2021a/lib:/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib:/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib:/software.el7/software/FFTW/3.3.9-gompi-2021a/lib:/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib:/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib:/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib:/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib:/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib:/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib:/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib:/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib:/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib:/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib:/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib:/software.el7/software/GCCcore/10.3.0/lib64 did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share'), PosixPath('1;/var/lib/flatpak/exports/share'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share'), PosixPath('1;/usr/share'), PosixPath('1;/storage/homefs/st20f757/.local/share/flatpak/exports/share'), PosixPath('1'), PosixPath('1;/usr/local/share')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/GCCcore/10.3.0'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;UCX/1.10.0-GCCcore-10.3.0'), PosixPath('1;HDF5/1.12.1-gompi-2021a'), PosixPath('1;OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('1;numactl/2.0.14-GCCcore-10.3.0'), PosixPath('1;FFTW/3.3.9-gompi-2021a'), PosixPath('1;Anaconda3/2021.11-foss-2021a'), PosixPath('1;Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('1;GCC/10.3.0'), PosixPath('1;gompi/2021a'), PosixPath('1;foss/2021a'), PosixPath('1;hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('GCCcore/10.3.0'), PosixPath('1;XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('1;libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('1;zlib/.1.2.11'), PosixPath('1;binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('1;OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('1;FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('1;ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('1'), PosixPath('1;libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('1;libxml2/.2.9.10-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/modulefiles/all/HDF5/1.12.1-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/XZ/.5.2.5-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/ScaLAPACK/2.1.0-gompi-2021a-fb.lua'), PosixPath('1;/software.el7/modulefiles/all/binutils/.2.36.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/UCX/1.10.0-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libxml2/.2.9.10-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/hwloc/2.4.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/FFTW/3.3.9-gompi-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/FlexiBLAS/3.0.4-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenMPI/4.1.1-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libfabric/1.12.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/libpciaccess/.0.16-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/Szip/.2.1.1-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/numactl/2.0.14-GCCcore-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/OpenBLAS/0.3.15-GCC-10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/zlib/.1.2.11.lua'), PosixPath('1'), PosixPath('1;/software.el7/modulefiles/all/GCC/10.3.0.lua'), PosixPath('1;/software.el7/modulefiles/all/gompi/2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/Anaconda3/2021.11-foss-2021a.lua'), PosixPath('1;/software.el7/modulefiles/all/foss/2021a.lua')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('XZ/.5.2.5-GCCcore-10.3.0'), PosixPath('HDF5/1.12.1-gompi-2021a'), PosixPath('numactl/2.0.14-GCCcore-10.3.0'), PosixPath('foss/2021a'), PosixPath('GCC/10.3.0'), PosixPath('ScaLAPACK/2.1.0-gompi-2021a-fb'), PosixPath('gompi/2021a'), PosixPath('OpenMPI/4.1.1-GCC-10.3.0'), PosixPath('binutils/.2.36.1-GCCcore-10.3.0'), PosixPath('Anaconda3/2021.11-foss-2021a'), PosixPath('libfabric/1.12.1-GCCcore-10.3.0'), PosixPath('FFTW/3.3.9-gompi-2021a'), PosixPath('OpenBLAS/0.3.15-GCC-10.3.0'), PosixPath('zlib/.1.2.11'), PosixPath('GCCcore/10.3.0'), PosixPath('hwloc/2.4.1-GCCcore-10.3.0'), PosixPath('UCX/1.10.0-GCCcore-10.3.0'), PosixPath('libpciaccess/.0.16-GCCcore-10.3.0'), PosixPath('FlexiBLAS/3.0.4-GCC-10.3.0'), PosixPath('Szip/.2.1.1-GCCcore-10.3.0'), PosixPath('libxml2/.2.9.10-GCCcore-10.3.0')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/storage/homefs/st20f757/.local/bin'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/bin'), PosixPath('1;/usr/sbin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/bin'), PosixPath('1;/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/google-cloud-sdk/bin'), PosixPath('2'), PosixPath('1;/usr/local/sbin'), PosixPath('2;/opt/puppetlabs/bin'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/sbin'), PosixPath('1;/usr/bin'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/bin'), PosixPath('1;/software.el7/lmod/lmod/libexec'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/bin'), PosixPath('2;/usr/local/bin'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/bin'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/bin'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/bin'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/bin'), PosixPath('1;/usr/lpp/mmfs/bin'), PosixPath('2;/storage/homefs/st20f757/bin'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/sbin'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/bin')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('+/usr/share/gnudatalanguage')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/include/flexiblas'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include/libxml2'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/include'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/include'), PosixPath('1'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/include'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/include')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib'), PosixPath('1;/software.el7/software/Szip/2.1.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/lib64'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib'), PosixPath('1'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/UCX/1.10.0-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/OpenBLAS/0.3.15-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/HDF5/1.12.1-gompi-2021a/lib/pkgconfig'), PosixPath('1;/software.el7/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib/pkgconfig'), PosixPath('1;/software.el7/software/zlib/1.2.11/lib/pkgconfig'), PosixPath('1;/software.el7/software/libpciaccess/0.16-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/lib/pkgconfig'), PosixPath('1')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('1;/software.el7/software/libfabric/1.12.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/FlexiBLAS/3.0.4-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/GCCcore/10.3.0/share/man'), PosixPath('1;/software.el7/software/XZ/5.2.5-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/libxml2/2.9.10-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/OpenMPI/4.1.1-GCC-10.3.0/share/man'), PosixPath('1;/software.el7/software/zlib/1.2.11/share/man'), PosixPath('1;/software.el7/software/FFTW/3.3.9-gompi-2021a/share/man'), PosixPath('1;/opt/puppetlabs/puppet/share/man'), PosixPath('1;/software.el7/software/numactl/2.0.14-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/binutils/2.36.1-GCCcore-10.3.0/share/man'), PosixPath('1'), PosixPath('1;/software.el7/software/hwloc/2.4.1-GCCcore-10.3.0/share/man'), PosixPath('1;/software.el7/software/Anaconda3/2021.11-foss-2021a/man')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('() {  eval $($LMOD_DIR/ml_cmd "$@")\n}')}
  warn(msg)
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/usr/local/cuda/lib64')}
  warn(msg)
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:147: UserWarning: WARNING: No libcudart.so found! Install CUDA or the cudatoolkit package (anaconda)!
  warn(msg)
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cpu.so...
{'accelerator': 'gpu',
 'accumulate_grad_batches': 1,
 'annotation': './data/mimic_cxr/annotation.json',
 'base_dir': '/storage/workspaces/artorg_aimi/ws_00000/sergio/radrep/mimic-cxr-jpg-google/files',
 'batch_size': 8,
 'beam_size': 3,
 'ckpt_file': None,
 'dataset': 'mimic_cxr',
 'delta_file': None,
 'devices': 2,
 'diversity_penalty': 0,
 'do_sample': False,
 'end_sym': '</s>',
 'every_n_train_steps': 0,
 'freeze_vm': True,
 'global_only': False,
 'gradient_clip_val': 1,
 'learning_rate': 0.0001,
 'length_penalty': 2.0,
 'limit_test_batches': 1.0,
 'limit_train_batches': 1.0,
 'limit_val_batches': 0.5,
 'llama_model': 'meta-llama/Llama-2-7b-chat-hf',
 'llm_alpha': 16,
 'llm_r': 16,
 'llm_use_lora': False,
 'lora_dropout': 0.1,
 'low_resource': True,
 'max_epochs': 5,
 'max_length': 100,
 'max_new_tokens': 120,
 'min_new_tokens': 80,
 'no_repeat_ngram_size': 2,
 'num_beam_groups': 1,
 'num_nodes': 1,
 'num_sanity_val_steps': 2,
 'num_workers': 8,
 'precision': '16',
 'prefetch_factor': 4,
 'repetition_penalty': 2.0,
 'savedmodel_path': './save/mimic_cxr/v1_shallow',
 'scorer_types': ['Bleu_4', 'CIDEr'],
 'strategy': 'ddp',
 'temperature': 0,
 'test': False,
 'test_batch_size': 16,
 'val_batch_size': 12,
 'val_check_interval': 0.5,
 'validate': False,
 'vis_alpha': 16,
 'vis_r': 16,
 'vis_use_lora': False,
 'vision_model': 'microsoft/swin-base-patch4-window7-224',
 'weights': [0.5, 0.5]}
[rank: 0] Global seed set to 42
/storage/homefs/st20f757/.conda/envs/rw/lib/python3.11/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loading vision encoder:microsoft/swin-base-patch4-window7-224
Some weights of the model checkpoint at microsoft/swin-base-patch4-window7-224 were not used when initializing SwinModel: ['classifier.weight', 'classifier.bias']
- This IS expected if you are initializing SwinModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SwinModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loading Frozen vision encoder:microsoft/swin-base-patch4-window7-224 -- Done
Loading LLAMA
Downloading tokenizer.model:   0%|          | 0.00/500k [00:00<?, ?B/s]Downloading tokenizer.model: 100%|██████████| 500k/500k [00:00<00:00, 42.3MB/s]
Downloading (…)cial_tokens_map.json:   0%|          | 0.00/414 [00:00<?, ?B/s]Downloading (…)cial_tokens_map.json: 100%|██████████| 414/414 [00:00<00:00, 2.90MB/s]
Downloading (…)okenizer_config.json:   0%|          | 0.00/776 [00:00<?, ?B/s]Downloading (…)okenizer_config.json: 100%|██████████| 776/776 [00:00<00:00, 9.38MB/s]
Downloading (…)lve/main/config.json:   0%|          | 0.00/614 [00:00<?, ?B/s]Downloading (…)lve/main/config.json: 100%|██████████| 614/614 [00:00<00:00, 3.77MB/s]
Downloading (…)fetensors.index.json:   0%|          | 0.00/26.8k [00:00<?, ?B/s]Downloading (…)fetensors.index.json: 100%|██████████| 26.8k/26.8k [00:00<00:00, 227MB/s]
Downloading shards:   0%|          | 0/2 [00:00<?, ?it/s]
Downloading (…)of-00002.safetensors:   0%|          | 0.00/9.98G [00:00<?, ?B/s][A
Downloading (…)of-00002.safetensors:   0%|          | 10.5M/9.98G [00:00<05:22, 30.9MB/s][A
Downloading (…)of-00002.safetensors:   0%|          | 21.0M/9.98G [00:00<05:25, 30.6MB/s][A
Downloading (…)of-00002.safetensors:   0%|          | 31.5M/9.98G [00:01<05:15, 31.6MB/s][A
Downloading (…)of-00002.safetensors:   0%|          | 41.9M/9.98G [00:01<05:16, 31.4MB/s][A
Downloading (…)of-00002.safetensors:   1%|          | 52.4M/9.98G [00:01<05:19, 31.0MB/s][A
Downloading (…)of-00002.safetensors:   1%|          | 62.9M/9.98G [00:02<05:22, 30.8MB/s][A
Downloading (…)of-00002.safetensors:   1%|          | 73.4M/9.98G [00:02<05:21, 30.8MB/s][A
Downloading (…)of-00002.safetensors:   1%|          | 83.9M/9.98G [00:02<05:21, 30.7MB/s][A
Downloading (…)of-00002.safetensors:   1%|          | 94.4M/9.98G [00:03<05:21, 30.8MB/s][A
Downloading (…)of-00002.safetensors:   1%|          | 105M/9.98G [00:03<05:22, 30.7MB/s] [A
Downloading (…)of-00002.safetensors:   1%|          | 115M/9.98G [00:03<05:21, 30.7MB/s][A
Downloading (…)of-00002.safetensors:   1%|▏         | 126M/9.98G [00:04<05:21, 30.7MB/s][A
Downloading (…)of-00002.safetensors:   1%|▏         | 136M/9.98G [00:04<05:20, 30.7MB/s][A
Downloading (…)of-00002.safetensors:   1%|▏         | 147M/9.98G [00:04<05:22, 30.5MB/s][A
Downloading (…)of-00002.safetensors:   2%|▏         | 157M/9.98G [00:05<05:21, 30.5MB/s][A
Downloading (…)of-00002.safetensors:   2%|▏         | 168M/9.98G [00:05<05:22, 30.4MB/s][A
Downloading (…)of-00002.safetensors:   2%|▏         | 178M/9.98G [00:05<05:22, 30.4MB/s][A
Downloading (…)of-00002.safetensors:   2%|▏         | 189M/9.98G [00:06<05:21, 30.4MB/s][A
Downloading (…)of-00002.safetensors:   2%|▏         | 199M/9.98G [00:06<05:21, 30.4MB/s][A
Downloading (…)of-00002.safetensors:   2%|▏         | 210M/9.98G [00:06<05:21, 30.3MB/s][A
Downloading (…)of-00002.safetensors:   2%|▏         | 220M/9.98G [00:07<05:20, 30.4MB/s][A
Downloading (…)of-00002.safetensors:   2%|▏         | 231M/9.98G [00:07<05:18, 30.6MB/s][A
Downloading (…)of-00002.safetensors:   2%|▏         | 241M/9.98G [00:07<05:51, 27.7MB/s][A
Downloading (…)of-00002.safetensors:   3%|▎         | 252M/9.98G [00:08<05:41, 28.5MB/s][A
Downloading (…)of-00002.safetensors:   3%|▎         | 262M/9.98G [00:08<05:29, 29.5MB/s][A
Downloading (…)of-00002.safetensors:   3%|▎         | 273M/9.98G [00:09<05:29, 29.5MB/s][A
Downloading (…)of-00002.safetensors:   3%|▎         | 283M/9.98G [00:09<05:26, 29.7MB/s][A
Downloading (…)of-00002.safetensors:   3%|▎         | 294M/9.98G [00:09<05:23, 29.9MB/s][A
Downloading (…)of-00002.safetensors:   3%|▎         | 304M/9.98G [00:10<06:20, 25.4MB/s][A
Downloading (…)of-00002.safetensors:   3%|▎         | 315M/9.98G [00:10<06:00, 26.8MB/s][A
Downloading (…)of-00002.safetensors:   3%|▎         | 325M/9.98G [00:10<05:48, 27.7MB/s][A
Downloading (…)of-00002.safetensors:   3%|▎         | 336M/9.98G [00:11<05:38, 28.5MB/s][A
Downloading (…)of-00002.safetensors:   3%|▎         | 346M/9.98G [00:11<05:31, 29.0MB/s][A
Downloading (…)of-00002.safetensors:   4%|▎         | 357M/9.98G [00:11<05:27, 29.4MB/s][A
Downloading (…)of-00002.safetensors:   4%|▎         | 367M/9.98G [00:12<05:21, 29.9MB/s][A
Downloading (…)of-00002.safetensors:   4%|▍         | 377M/9.98G [00:12<05:20, 30.0MB/s][A
Downloading (…)of-00002.safetensors:   4%|▍         | 388M/9.98G [00:13<05:17, 30.2MB/s][A
Downloading (…)of-00002.safetensors:   4%|▍         | 398M/9.98G [00:13<05:17, 30.2MB/s][A
Downloading (…)of-00002.safetensors:   4%|▍         | 409M/9.98G [00:13<05:20, 29.8MB/s][A
Downloading (…)of-00002.safetensors:   4%|▍         | 419M/9.98G [00:14<05:20, 29.8MB/s][A
Downloading (…)of-00002.safetensors:   4%|▍         | 430M/9.98G [00:14<05:18, 30.0MB/s][A
Downloading (…)of-00002.safetensors:   4%|▍         | 440M/9.98G [00:14<05:16, 30.1MB/s][A
Downloading (…)of-00002.safetensors:   5%|▍         | 451M/9.98G [00:15<05:15, 30.2MB/s][A
Downloading (…)of-00002.safetensors:   5%|▍         | 461M/9.98G [00:15<05:14, 30.2MB/s][A
Downloading (…)of-00002.safetensors:   5%|▍         | 472M/9.98G [00:15<05:13, 30.3MB/s][A
Downloading (…)of-00002.safetensors:   5%|▍         | 482M/9.98G [00:16<05:11, 30.4MB/s][A
Downloading (…)of-00002.safetensors:   5%|▍         | 493M/9.98G [00:16<05:10, 30.5MB/s][A
Downloading (…)of-00002.safetensors:   5%|▌         | 503M/9.98G [00:16<05:08, 30.7MB/s][A
Downloading (…)of-00002.safetensors:   5%|▌         | 514M/9.98G [00:17<05:08, 30.7MB/s][A
Downloading (…)of-00002.safetensors:   5%|▌         | 524M/9.98G [00:17<05:09, 30.5MB/s][A
Downloading (…)of-00002.safetensors:   5%|▌         | 535M/9.98G [00:17<05:09, 30.5MB/s][A
Downloading (…)of-00002.safetensors:   5%|▌         | 545M/9.98G [00:18<05:06, 30.8MB/s][A
Downloading (…)of-00002.safetensors:   6%|▌         | 556M/9.98G [00:18<05:06, 30.8MB/s][A
Downloading (…)of-00002.safetensors:   6%|▌         | 566M/9.98G [00:18<05:07, 30.6MB/s][A
Downloading (…)of-00002.safetensors:   6%|▌         | 577M/9.98G [00:19<05:07, 30.6MB/s][A
Downloading (…)of-00002.safetensors:   6%|▌         | 587M/9.98G [00:19<05:03, 31.0MB/s][A
Downloading (…)of-00002.safetensors:   6%|▌         | 598M/9.98G [00:19<04:59, 31.3MB/s][A
Downloading (…)of-00002.safetensors:   6%|▌         | 608M/9.98G [00:20<05:02, 31.0MB/s][A
Downloading (…)of-00002.safetensors:   6%|▌         | 619M/9.98G [00:20<05:55, 26.3MB/s][A
Downloading (…)of-00002.safetensors:   6%|▋         | 629M/9.98G [00:21<05:41, 27.4MB/s][A
Downloading (…)of-00002.safetensors:   6%|▋         | 640M/9.98G [00:21<05:29, 28.4MB/s][A
Downloading (…)of-00002.safetensors:   7%|▋         | 650M/9.98G [00:21<05:22, 28.9MB/s][A
Downloading (…)of-00002.safetensors:   7%|▋         | 661M/9.98G [00:22<05:17, 29.3MB/s][A
Downloading (…)of-00002.safetensors:   7%|▋         | 671M/9.98G [00:22<05:13, 29.7MB/s][A
Downloading (…)of-00002.safetensors:   7%|▋         | 682M/9.98G [00:22<05:11, 29.9MB/s][A
Downloading (…)of-00002.safetensors:   7%|▋         | 692M/9.98G [00:23<05:09, 30.0MB/s][A
Downloading (…)of-00002.safetensors:   7%|▋         | 703M/9.98G [00:23<05:06, 30.2MB/s][A
Downloading (…)of-00002.safetensors:   7%|▋         | 713M/9.98G [00:23<05:05, 30.3MB/s][A
Downloading (…)of-00002.safetensors:   7%|▋         | 724M/9.98G [00:24<05:00, 30.8MB/s][A
Downloading (…)of-00002.safetensors:   7%|▋         | 734M/9.98G [00:24<05:02, 30.6MB/s][A
Downloading (…)of-00002.safetensors:   7%|▋         | 744M/9.98G [00:24<05:02, 30.5MB/s][A
Downloading (…)of-00002.safetensors:   8%|▊         | 755M/9.98G [00:25<05:00, 30.7MB/s][A
Downloading (…)of-00002.safetensors:   8%|▊         | 765M/9.98G [00:25<04:58, 30.8MB/s][A
Downloading (…)of-00002.safetensors:   8%|▊         | 776M/9.98G [00:25<04:58, 30.8MB/s][A
Downloading (…)of-00002.safetensors:   8%|▊         | 786M/9.98G [00:26<04:59, 30.7MB/s][A
Downloading (…)of-00002.safetensors:   8%|▊         | 797M/9.98G [00:26<04:59, 30.6MB/s][A
Downloading (…)of-00002.safetensors:   8%|▊         | 807M/9.98G [00:26<04:58, 30.7MB/s][A
Downloading (…)of-00002.safetensors:   8%|▊         | 818M/9.98G [00:27<04:59, 30.6MB/s][A
Downloading (…)of-00002.safetensors:   8%|▊         | 828M/9.98G [00:27<04:56, 30.9MB/s][A
Downloading (…)of-00002.safetensors:   8%|▊         | 839M/9.98G [00:27<04:56, 30.8MB/s][A
Downloading (…)of-00002.safetensors:   9%|▊         | 849M/9.98G [00:28<04:52, 31.2MB/s][A
Downloading (…)of-00002.safetensors:   9%|▊         | 860M/9.98G [00:28<04:53, 31.1MB/s][A
Downloading (…)of-00002.safetensors:   9%|▊         | 870M/9.98G [00:28<04:53, 31.0MB/s][A
Downloading (…)of-00002.safetensors:   9%|▉         | 881M/9.98G [00:29<04:54, 30.8MB/s][A
Downloading (…)of-00002.safetensors:   9%|▉         | 891M/9.98G [00:29<04:55, 30.8MB/s][A
Downloading (…)of-00002.safetensors:   9%|▉         | 902M/9.98G [00:29<04:53, 30.9MB/s][A
Downloading (…)of-00002.safetensors:   9%|▉         | 912M/9.98G [00:30<04:45, 31.8MB/s][A
Downloading (…)of-00002.safetensors:   9%|▉         | 923M/9.98G [00:30<05:32, 27.2MB/s][A
Downloading (…)of-00002.safetensors:   9%|▉         | 933M/9.98G [00:31<05:18, 28.4MB/s][A
Downloading (…)of-00002.safetensors:   9%|▉         | 944M/9.98G [00:31<05:11, 29.0MB/s][A
Downloading (…)of-00002.safetensors:  10%|▉         | 954M/9.98G [00:31<05:05, 29.6MB/s][A
Downloading (…)of-00002.safetensors:  10%|▉         | 965M/9.98G [00:32<05:01, 29.9MB/s][A
Downloading (…)of-00002.safetensors:  10%|▉         | 975M/9.98G [00:32<04:57, 30.2MB/s][A
Downloading (…)of-00002.safetensors:  10%|▉         | 986M/9.98G [00:32<04:51, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  10%|▉         | 996M/9.98G [00:33<04:51, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  10%|█         | 1.01G/9.98G [00:33<04:52, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  10%|█         | 1.02G/9.98G [00:33<04:52, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  10%|█         | 1.03G/9.98G [00:34<04:52, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  10%|█         | 1.04G/9.98G [00:34<04:49, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  11%|█         | 1.05G/9.98G [00:34<04:46, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  11%|█         | 1.06G/9.98G [00:35<04:47, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  11%|█         | 1.07G/9.98G [00:35<04:48, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  11%|█         | 1.08G/9.98G [00:35<04:49, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  11%|█         | 1.09G/9.98G [00:36<04:50, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  11%|█         | 1.10G/9.98G [00:36<04:50, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  11%|█         | 1.11G/9.98G [00:36<04:50, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  11%|█         | 1.12G/9.98G [00:37<04:48, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  11%|█▏        | 1.13G/9.98G [00:37<04:44, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  11%|█▏        | 1.14G/9.98G [00:37<04:44, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  12%|█▏        | 1.15G/9.98G [00:38<04:45, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  12%|█▏        | 1.16G/9.98G [00:38<04:46, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  12%|█▏        | 1.17G/9.98G [00:38<04:47, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  12%|█▏        | 1.18G/9.98G [00:39<04:48, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  12%|█▏        | 1.20G/9.98G [00:39<04:47, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  12%|█▏        | 1.21G/9.98G [00:39<04:42, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  12%|█▏        | 1.22G/9.98G [00:40<04:41, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  12%|█▏        | 1.23G/9.98G [00:40<04:42, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  12%|█▏        | 1.24G/9.98G [00:41<05:38, 25.8MB/s][A
Downloading (…)of-00002.safetensors:  13%|█▎        | 1.25G/9.98G [00:41<05:22, 27.0MB/s][A
Downloading (…)of-00002.safetensors:  13%|█▎        | 1.26G/9.98G [00:41<05:11, 28.0MB/s][A
Downloading (…)of-00002.safetensors:  13%|█▎        | 1.27G/9.98G [00:42<05:03, 28.7MB/s][A
Downloading (…)of-00002.safetensors:  13%|█▎        | 1.28G/9.98G [00:42<04:56, 29.3MB/s][A
Downloading (…)of-00002.safetensors:  13%|█▎        | 1.29G/9.98G [00:42<04:50, 30.0MB/s][A
Downloading (…)of-00002.safetensors:  13%|█▎        | 1.30G/9.98G [00:43<04:49, 30.0MB/s][A
Downloading (…)of-00002.safetensors:  13%|█▎        | 1.31G/9.98G [00:43<04:47, 30.1MB/s][A
Downloading (…)of-00002.safetensors:  13%|█▎        | 1.32G/9.98G [00:43<04:46, 30.2MB/s][A
Downloading (…)of-00002.safetensors:  13%|█▎        | 1.33G/9.98G [00:44<04:44, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  13%|█▎        | 1.34G/9.98G [00:44<04:44, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  14%|█▎        | 1.35G/9.98G [00:44<04:44, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  14%|█▎        | 1.36G/9.98G [00:45<04:39, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  14%|█▍        | 1.37G/9.98G [00:45<04:33, 31.5MB/s][A
Downloading (…)of-00002.safetensors:  14%|█▍        | 1.38G/9.98G [00:45<04:34, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  14%|█▍        | 1.39G/9.98G [00:46<04:34, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  14%|█▍        | 1.41G/9.98G [00:46<04:32, 31.5MB/s][A
Downloading (…)of-00002.safetensors:  14%|█▍        | 1.42G/9.98G [00:46<04:34, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  14%|█▍        | 1.43G/9.98G [00:47<04:36, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  14%|█▍        | 1.44G/9.98G [00:47<04:38, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  15%|█▍        | 1.45G/9.98G [00:48<04:36, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  15%|█▍        | 1.46G/9.98G [00:48<04:32, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  15%|█▍        | 1.47G/9.98G [00:48<04:33, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  15%|█▍        | 1.48G/9.98G [00:49<04:34, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  15%|█▍        | 1.49G/9.98G [00:49<04:36, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  15%|█▌        | 1.50G/9.98G [00:49<04:32, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  15%|█▌        | 1.51G/9.98G [00:50<04:34, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  15%|█▌        | 1.52G/9.98G [00:50<04:34, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  15%|█▌        | 1.53G/9.98G [00:50<04:35, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  15%|█▌        | 1.54G/9.98G [00:51<05:21, 26.2MB/s][A
Downloading (…)of-00002.safetensors:  16%|█▌        | 1.55G/9.98G [00:51<05:08, 27.3MB/s][A
Downloading (…)of-00002.safetensors:  16%|█▌        | 1.56G/9.98G [00:51<04:58, 28.2MB/s][A
Downloading (…)of-00002.safetensors:  16%|█▌        | 1.57G/9.98G [00:52<04:49, 29.0MB/s][A
Downloading (…)of-00002.safetensors:  16%|█▌        | 1.58G/9.98G [00:52<04:45, 29.4MB/s][A
Downloading (…)of-00002.safetensors:  16%|█▌        | 1.59G/9.98G [00:52<04:39, 30.0MB/s][A
Downloading (…)of-00002.safetensors:  16%|█▌        | 1.60G/9.98G [00:53<04:37, 30.2MB/s][A
Downloading (…)of-00002.safetensors:  16%|█▌        | 1.61G/9.98G [00:53<04:37, 30.1MB/s][A
Downloading (…)of-00002.safetensors:  16%|█▋        | 1.63G/9.98G [00:53<04:34, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  16%|█▋        | 1.64G/9.98G [00:54<04:31, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  17%|█▋        | 1.65G/9.98G [00:54<04:31, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  17%|█▋        | 1.66G/9.98G [00:55<04:32, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  17%|█▋        | 1.67G/9.98G [00:55<04:31, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  17%|█▋        | 1.68G/9.98G [00:55<04:32, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  17%|█▋        | 1.69G/9.98G [00:56<04:31, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  17%|█▋        | 1.70G/9.98G [00:56<04:31, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  17%|█▋        | 1.71G/9.98G [00:56<04:30, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  17%|█▋        | 1.72G/9.98G [00:57<04:25, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  17%|█▋        | 1.73G/9.98G [00:57<04:26, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  17%|█▋        | 1.74G/9.98G [00:57<04:25, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  18%|█▊        | 1.75G/9.98G [00:58<04:24, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  18%|█▊        | 1.76G/9.98G [00:58<04:23, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  18%|█▊        | 1.77G/9.98G [00:58<04:25, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  18%|█▊        | 1.78G/9.98G [00:59<04:27, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  18%|█▊        | 1.79G/9.98G [00:59<04:27, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  18%|█▊        | 1.80G/9.98G [00:59<04:26, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  18%|█▊        | 1.81G/9.98G [01:00<04:26, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  18%|█▊        | 1.82G/9.98G [01:00<04:25, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  18%|█▊        | 1.84G/9.98G [01:00<04:25, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  18%|█▊        | 1.85G/9.98G [01:01<05:10, 26.2MB/s][A
Downloading (…)of-00002.safetensors:  19%|█▊        | 1.86G/9.98G [01:01<04:56, 27.4MB/s][A
Downloading (…)of-00002.safetensors:  19%|█▊        | 1.87G/9.98G [01:02<04:41, 28.8MB/s][A
Downloading (…)of-00002.safetensors:  19%|█▉        | 1.88G/9.98G [01:02<04:31, 29.8MB/s][A
Downloading (…)of-00002.safetensors:  19%|█▉        | 1.89G/9.98G [01:02<04:30, 29.9MB/s][A
Downloading (…)of-00002.safetensors:  19%|█▉        | 1.90G/9.98G [01:03<04:28, 30.1MB/s][A
Downloading (…)of-00002.safetensors:  19%|█▉        | 1.91G/9.98G [01:03<04:22, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  19%|█▉        | 1.92G/9.98G [01:03<04:20, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  19%|█▉        | 1.93G/9.98G [01:04<04:19, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  19%|█▉        | 1.94G/9.98G [01:04<04:18, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  20%|█▉        | 1.95G/9.98G [01:04<04:15, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  20%|█▉        | 1.96G/9.98G [01:04<04:13, 31.6MB/s][A
Downloading (…)of-00002.safetensors:  20%|█▉        | 1.97G/9.98G [01:05<04:15, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  20%|█▉        | 1.98G/9.98G [01:05<04:17, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  20%|█▉        | 1.99G/9.98G [01:06<04:18, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  20%|██        | 2.00G/9.98G [01:06<04:16, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  20%|██        | 2.01G/9.98G [01:06<04:17, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  20%|██        | 2.02G/9.98G [01:07<04:19, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  20%|██        | 2.03G/9.98G [01:07<04:19, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  20%|██        | 2.04G/9.98G [01:07<04:14, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  21%|██        | 2.06G/9.98G [01:08<04:10, 31.6MB/s][A
Downloading (…)of-00002.safetensors:  21%|██        | 2.07G/9.98G [01:08<04:11, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  21%|██        | 2.08G/9.98G [01:08<04:13, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  21%|██        | 2.09G/9.98G [01:09<04:15, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  21%|██        | 2.10G/9.98G [01:09<04:15, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  21%|██        | 2.11G/9.98G [01:09<04:14, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  21%|██        | 2.12G/9.98G [01:10<04:13, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  21%|██▏       | 2.13G/9.98G [01:10<04:12, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  21%|██▏       | 2.14G/9.98G [01:10<04:13, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  22%|██▏       | 2.15G/9.98G [01:11<04:13, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  22%|██▏       | 2.16G/9.98G [01:11<04:56, 26.3MB/s][A
Downloading (…)of-00002.safetensors:  22%|██▏       | 2.17G/9.98G [01:11<04:43, 27.5MB/s][A
Downloading (…)of-00002.safetensors:  22%|██▏       | 2.18G/9.98G [01:12<04:35, 28.3MB/s][A
Downloading (…)of-00002.safetensors:  22%|██▏       | 2.19G/9.98G [01:12<04:28, 29.0MB/s][A
Downloading (…)of-00002.safetensors:  22%|██▏       | 2.20G/9.98G [01:13<04:22, 29.6MB/s][A
Downloading (…)of-00002.safetensors:  22%|██▏       | 2.21G/9.98G [01:13<04:19, 30.0MB/s][A
Downloading (…)of-00002.safetensors:  22%|██▏       | 2.22G/9.98G [01:13<04:17, 30.1MB/s][A
Downloading (…)of-00002.safetensors:  22%|██▏       | 2.23G/9.98G [01:14<04:17, 30.1MB/s][A
Downloading (…)of-00002.safetensors:  22%|██▏       | 2.24G/9.98G [01:14<04:16, 30.1MB/s][A
Downloading (…)of-00002.safetensors:  23%|██▎       | 2.25G/9.98G [01:14<04:15, 30.2MB/s][A
Downloading (…)of-00002.safetensors:  23%|██▎       | 2.26G/9.98G [01:15<04:14, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  23%|██▎       | 2.28G/9.98G [01:15<04:12, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  23%|██▎       | 2.29G/9.98G [01:15<04:12, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  23%|██▎       | 2.30G/9.98G [01:16<04:08, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  23%|██▎       | 2.31G/9.98G [01:16<04:09, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  23%|██▎       | 2.32G/9.98G [01:16<04:09, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  23%|██▎       | 2.33G/9.98G [01:17<04:09, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  23%|██▎       | 2.34G/9.98G [01:17<04:09, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  24%|██▎       | 2.35G/9.98G [01:17<04:09, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  24%|██▎       | 2.36G/9.98G [01:18<04:09, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  24%|██▍       | 2.37G/9.98G [01:18<04:07, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  24%|██▍       | 2.38G/9.98G [01:18<04:06, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  24%|██▍       | 2.39G/9.98G [01:19<04:06, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  24%|██▍       | 2.40G/9.98G [01:19<04:07, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  24%|██▍       | 2.41G/9.98G [01:19<04:06, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  24%|██▍       | 2.42G/9.98G [01:20<04:05, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  24%|██▍       | 2.43G/9.98G [01:20<04:05, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  24%|██▍       | 2.44G/9.98G [01:20<04:06, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  25%|██▍       | 2.45G/9.98G [01:21<04:06, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  25%|██▍       | 2.46G/9.98G [01:21<04:52, 25.7MB/s][A
Downloading (…)of-00002.safetensors:  25%|██▍       | 2.47G/9.98G [01:22<04:38, 26.9MB/s][A
Downloading (…)of-00002.safetensors:  25%|██▍       | 2.49G/9.98G [01:22<04:28, 27.9MB/s][A
Downloading (…)of-00002.safetensors:  25%|██▌       | 2.50G/9.98G [01:22<04:21, 28.7MB/s][A
Downloading (…)of-00002.safetensors:  25%|██▌       | 2.51G/9.98G [01:23<04:14, 29.4MB/s][A
Downloading (…)of-00002.safetensors:  25%|██▌       | 2.52G/9.98G [01:23<04:10, 29.8MB/s][A
Downloading (…)of-00002.safetensors:  25%|██▌       | 2.53G/9.98G [01:23<04:09, 29.9MB/s][A
Downloading (…)of-00002.safetensors:  25%|██▌       | 2.54G/9.98G [01:24<04:07, 30.0MB/s][A
Downloading (…)of-00002.safetensors:  26%|██▌       | 2.55G/9.98G [01:24<04:04, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  26%|██▌       | 2.56G/9.98G [01:24<04:03, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  26%|██▌       | 2.57G/9.98G [01:25<04:03, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  26%|██▌       | 2.58G/9.98G [01:25<04:00, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  26%|██▌       | 2.59G/9.98G [01:25<04:01, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  26%|██▌       | 2.60G/9.98G [01:26<04:01, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  26%|██▌       | 2.61G/9.98G [01:26<04:00, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  26%|██▋       | 2.62G/9.98G [01:26<03:59, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  26%|██▋       | 2.63G/9.98G [01:27<03:51, 31.7MB/s][A
Downloading (…)of-00002.safetensors:  26%|██▋       | 2.64G/9.98G [01:27<03:46, 32.4MB/s][A
Downloading (…)of-00002.safetensors:  27%|██▋       | 2.65G/9.98G [01:27<03:44, 32.6MB/s][A
Downloading (…)of-00002.safetensors:  27%|██▋       | 2.66G/9.98G [01:28<03:48, 32.0MB/s][A
Downloading (…)of-00002.safetensors:  27%|██▋       | 2.67G/9.98G [01:28<03:49, 31.8MB/s][A
Downloading (…)of-00002.safetensors:  27%|██▋       | 2.68G/9.98G [01:28<03:52, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  27%|██▋       | 2.69G/9.98G [01:29<03:53, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  27%|██▋       | 2.71G/9.98G [01:29<03:55, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  27%|██▋       | 2.72G/9.98G [01:29<03:55, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  27%|██▋       | 2.73G/9.98G [01:30<03:56, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  27%|██▋       | 2.74G/9.98G [01:30<03:53, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  28%|██▊       | 2.75G/9.98G [01:30<03:47, 31.8MB/s][A
Downloading (…)of-00002.safetensors:  28%|██▊       | 2.76G/9.98G [01:31<03:41, 32.5MB/s][A
Downloading (…)of-00002.safetensors:  28%|██▊       | 2.77G/9.98G [01:31<03:39, 32.9MB/s][A
Downloading (…)of-00002.safetensors:  28%|██▊       | 2.78G/9.98G [01:32<04:24, 27.2MB/s][A
Downloading (…)of-00002.safetensors:  28%|██▊       | 2.79G/9.98G [01:32<04:14, 28.2MB/s][A
Downloading (…)of-00002.safetensors:  28%|██▊       | 2.80G/9.98G [01:32<04:08, 28.9MB/s][A
Downloading (…)of-00002.safetensors:  28%|██▊       | 2.81G/9.98G [01:33<04:04, 29.3MB/s][A
Downloading (…)of-00002.safetensors:  28%|██▊       | 2.82G/9.98G [01:33<03:56, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  28%|██▊       | 2.83G/9.98G [01:33<03:48, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  28%|██▊       | 2.84G/9.98G [01:34<03:46, 31.5MB/s][A
Downloading (…)of-00002.safetensors:  29%|██▊       | 2.85G/9.98G [01:34<03:47, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  29%|██▊       | 2.86G/9.98G [01:34<03:47, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  29%|██▉       | 2.87G/9.98G [01:35<03:49, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  29%|██▉       | 2.88G/9.98G [01:35<03:50, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  29%|██▉       | 2.89G/9.98G [01:35<03:49, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  29%|██▉       | 2.90G/9.98G [01:36<03:45, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  29%|██▉       | 2.92G/9.98G [01:36<03:40, 32.0MB/s][A
Downloading (…)of-00002.safetensors:  29%|██▉       | 2.93G/9.98G [01:36<03:35, 32.7MB/s][A
Downloading (…)of-00002.safetensors:  29%|██▉       | 2.94G/9.98G [01:36<03:34, 32.8MB/s][A
Downloading (…)of-00002.safetensors:  30%|██▉       | 2.95G/9.98G [01:37<03:38, 32.1MB/s][A
Downloading (…)of-00002.safetensors:  30%|██▉       | 2.96G/9.98G [01:37<03:40, 31.8MB/s][A
Downloading (…)of-00002.safetensors:  30%|██▉       | 2.97G/9.98G [01:37<03:39, 32.0MB/s][A
Downloading (…)of-00002.safetensors:  30%|██▉       | 2.98G/9.98G [01:38<03:40, 31.7MB/s][A
Downloading (…)of-00002.safetensors:  30%|██▉       | 2.99G/9.98G [01:38<03:41, 31.6MB/s][A
Downloading (…)of-00002.safetensors:  30%|███       | 3.00G/9.98G [01:38<03:43, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  30%|███       | 3.01G/9.98G [01:39<03:45, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  30%|███       | 3.02G/9.98G [01:39<03:44, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  30%|███       | 3.03G/9.98G [01:40<03:44, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  30%|███       | 3.04G/9.98G [01:40<03:46, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  31%|███       | 3.05G/9.98G [01:40<03:46, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  31%|███       | 3.06G/9.98G [01:41<03:47, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  31%|███       | 3.07G/9.98G [01:41<03:46, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  31%|███       | 3.08G/9.98G [01:41<03:46, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  31%|███       | 3.09G/9.98G [01:42<05:05, 22.5MB/s][A
Downloading (…)of-00002.safetensors:  31%|███       | 3.10G/9.98G [01:42<04:39, 24.6MB/s][A
Downloading (…)of-00002.safetensors:  31%|███       | 3.11G/9.98G [01:43<04:23, 26.0MB/s][A
Downloading (…)of-00002.safetensors:  31%|███▏      | 3.12G/9.98G [01:43<04:11, 27.2MB/s][A
Downloading (…)of-00002.safetensors:  31%|███▏      | 3.14G/9.98G [01:43<03:58, 28.6MB/s][A
Downloading (…)of-00002.safetensors:  32%|███▏      | 3.15G/9.98G [01:44<03:52, 29.3MB/s][A
Downloading (…)of-00002.safetensors:  32%|███▏      | 3.16G/9.98G [01:44<03:50, 29.6MB/s][A
Downloading (…)of-00002.safetensors:  32%|███▏      | 3.17G/9.98G [01:44<03:48, 29.8MB/s][A
Downloading (…)of-00002.safetensors:  32%|███▏      | 3.18G/9.98G [01:45<03:44, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  32%|███▏      | 3.19G/9.98G [01:45<03:41, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  32%|███▏      | 3.20G/9.98G [01:45<03:41, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  32%|███▏      | 3.21G/9.98G [01:46<03:42, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  32%|███▏      | 3.22G/9.98G [01:46<03:42, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  32%|███▏      | 3.23G/9.98G [01:46<03:41, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  32%|███▏      | 3.24G/9.98G [01:47<03:36, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  33%|███▎      | 3.25G/9.98G [01:47<03:36, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  33%|███▎      | 3.26G/9.98G [01:47<03:37, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  33%|███▎      | 3.27G/9.98G [01:48<03:38, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  33%|███▎      | 3.28G/9.98G [01:48<03:37, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  33%|███▎      | 3.29G/9.98G [01:48<03:36, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  33%|███▎      | 3.30G/9.98G [01:49<03:36, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  33%|███▎      | 3.31G/9.98G [01:49<03:36, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  33%|███▎      | 3.32G/9.98G [01:49<03:30, 31.6MB/s][A
Downloading (…)of-00002.safetensors:  33%|███▎      | 3.33G/9.98G [01:50<03:28, 31.9MB/s][A
Downloading (…)of-00002.safetensors:  34%|███▎      | 3.34G/9.98G [01:50<03:26, 32.1MB/s][A
Downloading (…)of-00002.safetensors:  34%|███▎      | 3.36G/9.98G [01:50<03:28, 31.8MB/s][A
Downloading (…)of-00002.safetensors:  34%|███▎      | 3.37G/9.98G [01:51<03:31, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  34%|███▍      | 3.38G/9.98G [01:51<03:29, 31.5MB/s][A
Downloading (…)of-00002.safetensors:  34%|███▍      | 3.39G/9.98G [01:51<03:31, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  34%|███▍      | 3.40G/9.98G [01:52<03:33, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  34%|███▍      | 3.41G/9.98G [01:52<04:09, 26.4MB/s][A
Downloading (…)of-00002.safetensors:  34%|███▍      | 3.42G/9.98G [01:53<03:57, 27.7MB/s][A
Downloading (…)of-00002.safetensors:  34%|███▍      | 3.43G/9.98G [01:53<03:50, 28.5MB/s][A
Downloading (…)of-00002.safetensors:  34%|███▍      | 3.44G/9.98G [01:53<03:43, 29.2MB/s][A
Downloading (…)of-00002.safetensors:  35%|███▍      | 3.45G/9.98G [01:54<03:34, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  35%|███▍      | 3.46G/9.98G [01:54<03:26, 31.5MB/s][A
Downloading (…)of-00002.safetensors:  35%|███▍      | 3.47G/9.98G [01:54<03:21, 32.2MB/s][A
Downloading (…)of-00002.safetensors:  35%|███▍      | 3.48G/9.98G [01:55<03:18, 32.8MB/s][A
Downloading (…)of-00002.safetensors:  35%|███▍      | 3.49G/9.98G [01:55<03:20, 32.3MB/s][A
Downloading (…)of-00002.safetensors:  35%|███▌      | 3.50G/9.98G [01:55<03:24, 31.6MB/s][A
Downloading (…)of-00002.safetensors:  35%|███▌      | 3.51G/9.98G [01:56<03:26, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  35%|███▌      | 3.52G/9.98G [01:56<03:28, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  35%|███▌      | 3.53G/9.98G [01:56<03:25, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  36%|███▌      | 3.54G/9.98G [01:57<03:24, 31.5MB/s][A
Downloading (…)of-00002.safetensors:  36%|███▌      | 3.55G/9.98G [01:57<03:21, 31.8MB/s][A
Downloading (…)of-00002.safetensors:  36%|███▌      | 3.57G/9.98G [01:57<03:22, 31.6MB/s][A
Downloading (…)of-00002.safetensors:  36%|███▌      | 3.58G/9.98G [01:58<03:21, 31.8MB/s][A
Downloading (…)of-00002.safetensors:  36%|███▌      | 3.59G/9.98G [01:58<03:23, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  36%|███▌      | 3.60G/9.98G [01:58<03:25, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  36%|███▌      | 3.61G/9.98G [01:59<03:26, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  36%|███▋      | 3.62G/9.98G [01:59<03:26, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  36%|███▋      | 3.63G/9.98G [01:59<03:26, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  36%|███▋      | 3.64G/9.98G [02:00<03:26, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  37%|███▋      | 3.65G/9.98G [02:00<03:27, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  37%|███▋      | 3.66G/9.98G [02:00<03:26, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  37%|███▋      | 3.67G/9.98G [02:01<03:26, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  37%|███▋      | 3.68G/9.98G [02:01<03:26, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  37%|███▋      | 3.69G/9.98G [02:01<03:25, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  37%|███▋      | 3.70G/9.98G [02:02<03:22, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  37%|███▋      | 3.71G/9.98G [02:02<03:23, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  37%|███▋      | 3.72G/9.98G [02:03<04:02, 25.8MB/s][A
Downloading (…)of-00002.safetensors:  37%|███▋      | 3.73G/9.98G [02:03<03:50, 27.0MB/s][A
Downloading (…)of-00002.safetensors:  38%|███▊      | 3.74G/9.98G [02:03<03:42, 28.0MB/s][A
Downloading (…)of-00002.safetensors:  38%|███▊      | 3.75G/9.98G [02:04<03:36, 28.7MB/s][A
Downloading (…)of-00002.safetensors:  38%|███▊      | 3.76G/9.98G [02:04<03:32, 29.2MB/s][A
Downloading (…)of-00002.safetensors:  38%|███▊      | 3.77G/9.98G [02:04<03:29, 29.6MB/s][A
Downloading (…)of-00002.safetensors:  38%|███▊      | 3.79G/9.98G [02:05<03:26, 29.9MB/s][A
Downloading (…)of-00002.safetensors:  38%|███▊      | 3.80G/9.98G [02:05<03:24, 30.2MB/s][A
Downloading (…)of-00002.safetensors:  38%|███▊      | 3.81G/9.98G [02:05<03:23, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  38%|███▊      | 3.82G/9.98G [02:06<03:21, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  38%|███▊      | 3.83G/9.98G [02:06<03:20, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  38%|███▊      | 3.84G/9.98G [02:06<03:20, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  39%|███▊      | 3.85G/9.98G [02:07<03:20, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  39%|███▊      | 3.86G/9.98G [02:07<03:21, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  39%|███▉      | 3.87G/9.98G [02:07<03:17, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  39%|███▉      | 3.88G/9.98G [02:08<03:14, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  39%|███▉      | 3.89G/9.98G [02:08<03:09, 32.0MB/s][A
Downloading (…)of-00002.safetensors:  39%|███▉      | 3.90G/9.98G [02:08<03:10, 31.9MB/s][A
Downloading (…)of-00002.safetensors:  39%|███▉      | 3.91G/9.98G [02:09<03:12, 31.5MB/s][A
Downloading (…)of-00002.safetensors:  39%|███▉      | 3.92G/9.98G [02:09<03:13, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  39%|███▉      | 3.93G/9.98G [02:09<03:14, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  40%|███▉      | 3.94G/9.98G [02:10<03:16, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  40%|███▉      | 3.95G/9.98G [02:10<03:15, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  40%|███▉      | 3.96G/9.98G [02:10<03:17, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  40%|███▉      | 3.97G/9.98G [02:11<03:16, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  40%|███▉      | 3.98G/9.98G [02:11<03:16, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  40%|████      | 4.00G/9.98G [02:11<03:16, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  40%|████      | 4.01G/9.98G [02:12<03:16, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  40%|████      | 4.02G/9.98G [02:12<03:15, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  40%|████      | 4.03G/9.98G [02:13<03:48, 26.0MB/s][A
Downloading (…)of-00002.safetensors:  40%|████      | 4.04G/9.98G [02:13<03:35, 27.5MB/s][A
Downloading (…)of-00002.safetensors:  41%|████      | 4.05G/9.98G [02:13<03:25, 28.8MB/s][A
Downloading (…)of-00002.safetensors:  41%|████      | 4.06G/9.98G [02:14<03:21, 29.4MB/s][A
Downloading (…)of-00002.safetensors:  41%|████      | 4.07G/9.98G [02:14<03:16, 30.0MB/s][A
Downloading (…)of-00002.safetensors:  41%|████      | 4.08G/9.98G [02:14<03:15, 30.1MB/s][A
Downloading (…)of-00002.safetensors:  41%|████      | 4.09G/9.98G [02:15<03:13, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  41%|████      | 4.10G/9.98G [02:15<03:12, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  41%|████      | 4.11G/9.98G [02:15<03:11, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  41%|████▏     | 4.12G/9.98G [02:16<03:11, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  41%|████▏     | 4.13G/9.98G [02:16<03:12, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  42%|████▏     | 4.14G/9.98G [02:16<03:11, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  42%|████▏     | 4.15G/9.98G [02:17<03:11, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  42%|████▏     | 4.16G/9.98G [02:17<03:11, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  42%|████▏     | 4.17G/9.98G [02:17<03:07, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  42%|████▏     | 4.18G/9.98G [02:18<03:08, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  42%|████▏     | 4.19G/9.98G [02:18<03:07, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  42%|████▏     | 4.20G/9.98G [02:18<03:08, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  42%|████▏     | 4.22G/9.98G [02:19<03:05, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  42%|████▏     | 4.23G/9.98G [02:19<03:05, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  42%|████▏     | 4.24G/9.98G [02:19<03:07, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  43%|████▎     | 4.25G/9.98G [02:20<03:07, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  43%|████▎     | 4.26G/9.98G [02:20<03:07, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  43%|████▎     | 4.27G/9.98G [02:21<03:06, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  43%|████▎     | 4.28G/9.98G [02:21<03:05, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  43%|████▎     | 4.29G/9.98G [02:21<03:02, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  43%|████▎     | 4.30G/9.98G [02:22<03:02, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  43%|████▎     | 4.31G/9.98G [02:22<03:02, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  43%|████▎     | 4.32G/9.98G [02:22<03:02, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  43%|████▎     | 4.33G/9.98G [02:23<03:34, 26.3MB/s][A
Downloading (…)of-00002.safetensors:  44%|████▎     | 4.34G/9.98G [02:23<03:25, 27.4MB/s][A
Downloading (…)of-00002.safetensors:  44%|████▎     | 4.35G/9.98G [02:23<03:14, 28.9MB/s][A
Downloading (…)of-00002.safetensors:  44%|████▎     | 4.36G/9.98G [02:24<03:05, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  44%|████▍     | 4.37G/9.98G [02:24<02:58, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  44%|████▍     | 4.38G/9.98G [02:24<02:55, 31.9MB/s][A
Downloading (…)of-00002.safetensors:  44%|████▍     | 4.39G/9.98G [02:25<02:54, 31.9MB/s][A
Downloading (…)of-00002.safetensors:  44%|████▍     | 4.40G/9.98G [02:25<02:57, 31.5MB/s][A
Downloading (…)of-00002.safetensors:  44%|████▍     | 4.41G/9.98G [02:25<02:56, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  44%|████▍     | 4.42G/9.98G [02:26<02:55, 31.6MB/s][A
Downloading (…)of-00002.safetensors:  44%|████▍     | 4.44G/9.98G [02:26<02:57, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  45%|████▍     | 4.45G/9.98G [02:26<02:57, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  45%|████▍     | 4.46G/9.98G [02:27<02:56, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  45%|████▍     | 4.47G/9.98G [02:27<02:56, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  45%|████▍     | 4.48G/9.98G [02:27<02:57, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  45%|████▍     | 4.49G/9.98G [02:28<02:58, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  45%|████▌     | 4.50G/9.98G [02:28<02:59, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  45%|████▌     | 4.51G/9.98G [02:28<02:58, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  45%|████▌     | 4.52G/9.98G [02:29<02:57, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  45%|████▌     | 4.53G/9.98G [02:29<02:57, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  46%|████▌     | 4.54G/9.98G [02:29<02:57, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  46%|████▌     | 4.55G/9.98G [02:30<02:57, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  46%|████▌     | 4.56G/9.98G [02:30<02:57, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  46%|████▌     | 4.57G/9.98G [02:30<02:57, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  46%|████▌     | 4.58G/9.98G [02:31<02:58, 30.2MB/s][A
Downloading (…)of-00002.safetensors:  46%|████▌     | 4.59G/9.98G [02:31<02:59, 29.9MB/s][A
Downloading (…)of-00002.safetensors:  46%|████▌     | 4.60G/9.98G [02:31<02:57, 30.2MB/s][A
Downloading (…)of-00002.safetensors:  46%|████▌     | 4.61G/9.98G [02:32<02:57, 30.2MB/s][A
Downloading (…)of-00002.safetensors:  46%|████▋     | 4.62G/9.98G [02:32<02:56, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  46%|████▋     | 4.63G/9.98G [02:33<02:55, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  47%|████▋     | 4.65G/9.98G [02:33<03:53, 22.8MB/s][A
Downloading (…)of-00002.safetensors:  47%|████▋     | 4.66G/9.98G [02:34<03:34, 24.8MB/s][A
Downloading (…)of-00002.safetensors:  47%|████▋     | 4.67G/9.98G [02:34<03:21, 26.3MB/s][A
Downloading (…)of-00002.safetensors:  47%|████▋     | 4.68G/9.98G [02:34<03:13, 27.3MB/s][A
Downloading (…)of-00002.safetensors:  47%|████▋     | 4.69G/9.98G [02:35<03:06, 28.3MB/s][A
Downloading (…)of-00002.safetensors:  47%|████▋     | 4.70G/9.98G [02:35<03:00, 29.2MB/s][A
Downloading (…)of-00002.safetensors:  47%|████▋     | 4.71G/9.98G [02:35<02:57, 29.7MB/s][A
Downloading (…)of-00002.safetensors:  47%|████▋     | 4.72G/9.98G [02:36<02:57, 29.7MB/s][A
Downloading (…)of-00002.safetensors:  47%|████▋     | 4.73G/9.98G [02:36<02:54, 30.1MB/s][A
Downloading (…)of-00002.safetensors:  48%|████▊     | 4.74G/9.98G [02:36<02:53, 30.2MB/s][A
Downloading (…)of-00002.safetensors:  48%|████▊     | 4.75G/9.98G [02:37<02:52, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  48%|████▊     | 4.76G/9.98G [02:37<02:52, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  48%|████▊     | 4.77G/9.98G [02:37<02:51, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  48%|████▊     | 4.78G/9.98G [02:38<02:50, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  48%|████▊     | 4.79G/9.98G [02:38<02:48, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  48%|████▊     | 4.80G/9.98G [02:38<02:48, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  48%|████▊     | 4.81G/9.98G [02:39<02:48, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  48%|████▊     | 4.82G/9.98G [02:39<02:48, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  48%|████▊     | 4.83G/9.98G [02:39<02:48, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  49%|████▊     | 4.84G/9.98G [02:40<02:48, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  49%|████▊     | 4.85G/9.98G [02:40<02:48, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  49%|████▉     | 4.87G/9.98G [02:40<02:47, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  49%|████▉     | 4.88G/9.98G [02:41<02:47, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  49%|████▉     | 4.89G/9.98G [02:41<02:47, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  49%|████▉     | 4.90G/9.98G [02:41<02:46, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  49%|████▉     | 4.91G/9.98G [02:42<02:46, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  49%|████▉     | 4.92G/9.98G [02:42<02:46, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  49%|████▉     | 4.93G/9.98G [02:43<02:46, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  50%|████▉     | 4.94G/9.98G [02:43<02:45, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  50%|████▉     | 4.95G/9.98G [02:43<03:13, 26.0MB/s][A
Downloading (…)of-00002.safetensors:  50%|████▉     | 4.96G/9.98G [02:44<03:03, 27.4MB/s][A
Downloading (…)of-00002.safetensors:  50%|████▉     | 4.97G/9.98G [02:44<02:57, 28.2MB/s][A
Downloading (…)of-00002.safetensors:  50%|████▉     | 4.98G/9.98G [02:44<02:52, 28.9MB/s][A
Downloading (…)of-00002.safetensors:  50%|█████     | 4.99G/9.98G [02:45<02:50, 29.3MB/s][A
Downloading (…)of-00002.safetensors:  50%|█████     | 5.00G/9.98G [02:45<02:46, 29.9MB/s][A
Downloading (…)of-00002.safetensors:  50%|█████     | 5.01G/9.98G [02:45<02:44, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  50%|█████     | 5.02G/9.98G [02:46<02:42, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  50%|█████     | 5.03G/9.98G [02:46<02:42, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  51%|█████     | 5.04G/9.98G [02:46<02:41, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  51%|█████     | 5.05G/9.98G [02:47<02:41, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  51%|█████     | 5.06G/9.98G [02:47<02:40, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  51%|█████     | 5.08G/9.98G [02:48<02:40, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  51%|█████     | 5.09G/9.98G [02:48<02:40, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  51%|█████     | 5.10G/9.98G [02:48<02:40, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  51%|█████     | 5.11G/9.98G [02:49<02:39, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  51%|█████▏    | 5.12G/9.98G [02:49<02:39, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  51%|█████▏    | 5.13G/9.98G [02:49<02:37, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  52%|█████▏    | 5.14G/9.98G [02:50<02:33, 31.5MB/s][A
Downloading (…)of-00002.safetensors:  52%|█████▏    | 5.15G/9.98G [02:50<02:29, 32.3MB/s][A
Downloading (…)of-00002.safetensors:  52%|█████▏    | 5.16G/9.98G [02:50<02:26, 32.9MB/s][A
Downloading (…)of-00002.safetensors:  52%|█████▏    | 5.17G/9.98G [02:50<02:26, 32.7MB/s][A
Downloading (…)of-00002.safetensors:  52%|█████▏    | 5.18G/9.98G [02:51<02:29, 32.2MB/s][A
Downloading (…)of-00002.safetensors:  52%|█████▏    | 5.19G/9.98G [02:51<02:31, 31.6MB/s][A
Downloading (…)of-00002.safetensors:  52%|█████▏    | 5.20G/9.98G [02:51<02:33, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  52%|█████▏    | 5.21G/9.98G [02:52<02:33, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  52%|█████▏    | 5.22G/9.98G [02:52<02:33, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  52%|█████▏    | 5.23G/9.98G [02:53<02:33, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  53%|█████▎    | 5.24G/9.98G [02:53<02:32, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  53%|█████▎    | 5.25G/9.98G [02:53<02:31, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  53%|█████▎    | 5.26G/9.98G [02:54<02:59, 26.2MB/s][A
Downloading (…)of-00002.safetensors:  53%|█████▎    | 5.27G/9.98G [02:54<02:48, 27.9MB/s][A
Downloading (…)of-00002.safetensors:  53%|█████▎    | 5.28G/9.98G [02:54<02:43, 28.7MB/s][A
Downloading (…)of-00002.safetensors:  53%|█████▎    | 5.30G/9.98G [02:55<02:40, 29.2MB/s][A
Downloading (…)of-00002.safetensors:  53%|█████▎    | 5.31G/9.98G [02:55<02:36, 29.9MB/s][A
Downloading (…)of-00002.safetensors:  53%|█████▎    | 5.32G/9.98G [02:55<02:34, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  53%|█████▎    | 5.33G/9.98G [02:56<02:33, 30.2MB/s][A
Downloading (…)of-00002.safetensors:  53%|█████▎    | 5.34G/9.98G [02:56<02:32, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  54%|█████▎    | 5.35G/9.98G [02:56<02:32, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  54%|█████▎    | 5.36G/9.98G [02:57<02:30, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  54%|█████▍    | 5.37G/9.98G [02:57<02:24, 31.8MB/s][A
Downloading (…)of-00002.safetensors:  54%|█████▍    | 5.38G/9.98G [02:57<02:22, 32.3MB/s][A
Downloading (…)of-00002.safetensors:  54%|█████▍    | 5.39G/9.98G [02:58<02:22, 32.1MB/s][A
Downloading (…)of-00002.safetensors:  54%|█████▍    | 5.40G/9.98G [02:58<02:24, 31.7MB/s][A
Downloading (…)of-00002.safetensors:  54%|█████▍    | 5.41G/9.98G [02:58<02:26, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  54%|█████▍    | 5.42G/9.98G [02:59<02:26, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  54%|█████▍    | 5.43G/9.98G [02:59<02:24, 31.5MB/s][A
Downloading (…)of-00002.safetensors:  55%|█████▍    | 5.44G/9.98G [02:59<02:25, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  55%|█████▍    | 5.45G/9.98G [03:00<02:26, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  55%|█████▍    | 5.46G/9.98G [03:00<02:26, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  55%|█████▍    | 5.47G/9.98G [03:00<02:27, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  55%|█████▍    | 5.48G/9.98G [03:01<02:25, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  55%|█████▌    | 5.49G/9.98G [03:01<02:24, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  55%|█████▌    | 5.51G/9.98G [03:01<02:24, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  55%|█████▌    | 5.52G/9.98G [03:02<02:24, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  55%|█████▌    | 5.53G/9.98G [03:02<02:24, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  55%|█████▌    | 5.54G/9.98G [03:02<02:24, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  56%|█████▌    | 5.55G/9.98G [03:03<02:24, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  56%|█████▌    | 5.56G/9.98G [03:03<02:24, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  56%|█████▌    | 5.57G/9.98G [03:04<02:24, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  56%|█████▌    | 5.58G/9.98G [03:04<02:48, 26.1MB/s][A
Downloading (…)of-00002.safetensors:  56%|█████▌    | 5.59G/9.98G [03:04<02:40, 27.3MB/s][A
Downloading (…)of-00002.safetensors:  56%|█████▌    | 5.60G/9.98G [03:05<02:35, 28.1MB/s][A
Downloading (…)of-00002.safetensors:  56%|█████▌    | 5.61G/9.98G [03:05<02:31, 28.8MB/s][A
Downloading (…)of-00002.safetensors:  56%|█████▋    | 5.62G/9.98G [03:05<02:29, 29.2MB/s][A
Downloading (…)of-00002.safetensors:  56%|█████▋    | 5.63G/9.98G [03:06<02:26, 29.6MB/s][A
Downloading (…)of-00002.safetensors:  57%|█████▋    | 5.64G/9.98G [03:06<02:21, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  57%|█████▋    | 5.65G/9.98G [03:06<02:19, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  57%|█████▋    | 5.66G/9.98G [03:07<02:18, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  57%|█████▋    | 5.67G/9.98G [03:07<02:19, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  57%|█████▋    | 5.68G/9.98G [03:07<02:18, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  57%|█████▋    | 5.69G/9.98G [03:08<02:18, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  57%|█████▋    | 5.70G/9.98G [03:08<02:17, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  57%|█████▋    | 5.71G/9.98G [03:08<02:16, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  57%|█████▋    | 5.73G/9.98G [03:09<02:17, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  57%|█████▋    | 5.74G/9.98G [03:09<02:17, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  58%|█████▊    | 5.75G/9.98G [03:09<02:16, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  58%|█████▊    | 5.76G/9.98G [03:10<02:15, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  58%|█████▊    | 5.77G/9.98G [03:10<02:14, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  58%|█████▊    | 5.78G/9.98G [03:10<02:13, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  58%|█████▊    | 5.79G/9.98G [03:11<02:14, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  58%|█████▊    | 5.80G/9.98G [03:11<02:15, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  58%|█████▊    | 5.81G/9.98G [03:11<02:14, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  58%|█████▊    | 5.82G/9.98G [03:12<02:14, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  58%|█████▊    | 5.83G/9.98G [03:12<02:15, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  59%|█████▊    | 5.84G/9.98G [03:13<02:15, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  59%|█████▊    | 5.85G/9.98G [03:13<02:14, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  59%|█████▉    | 5.86G/9.98G [03:13<02:13, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  59%|█████▉    | 5.87G/9.98G [03:14<02:13, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  59%|█████▉    | 5.88G/9.98G [03:14<02:38, 25.8MB/s][A
Downloading (…)of-00002.safetensors:  59%|█████▉    | 5.89G/9.98G [03:14<02:31, 27.0MB/s][A
Downloading (…)of-00002.safetensors:  59%|█████▉    | 5.90G/9.98G [03:15<02:25, 27.9MB/s][A
Downloading (…)of-00002.safetensors:  59%|█████▉    | 5.91G/9.98G [03:15<02:20, 28.9MB/s][A
Downloading (…)of-00002.safetensors:  59%|█████▉    | 5.92G/9.98G [03:15<02:17, 29.6MB/s][A
Downloading (…)of-00002.safetensors:  59%|█████▉    | 5.93G/9.98G [03:16<02:14, 30.0MB/s][A
Downloading (…)of-00002.safetensors:  60%|█████▉    | 5.95G/9.98G [03:16<02:14, 30.1MB/s][A
Downloading (…)of-00002.safetensors:  60%|█████▉    | 5.96G/9.98G [03:16<02:12, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  60%|█████▉    | 5.97G/9.98G [03:17<02:11, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  60%|█████▉    | 5.98G/9.98G [03:17<02:07, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  60%|██████    | 5.99G/9.98G [03:17<02:07, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  60%|██████    | 6.00G/9.98G [03:18<02:07, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  60%|██████    | 6.01G/9.98G [03:18<02:07, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  60%|██████    | 6.02G/9.98G [03:19<02:08, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  60%|██████    | 6.03G/9.98G [03:19<02:08, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  61%|██████    | 6.04G/9.98G [03:19<02:08, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  61%|██████    | 6.05G/9.98G [03:20<02:06, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  61%|██████    | 6.06G/9.98G [03:20<02:04, 31.5MB/s][A
Downloading (…)of-00002.safetensors:  61%|██████    | 6.07G/9.98G [03:20<02:03, 31.7MB/s][A
Downloading (…)of-00002.safetensors:  61%|██████    | 6.08G/9.98G [03:21<02:04, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  61%|██████    | 6.09G/9.98G [03:21<02:05, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  61%|██████    | 6.10G/9.98G [03:21<02:05, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  61%|██████▏   | 6.11G/9.98G [03:22<02:06, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  61%|██████▏   | 6.12G/9.98G [03:22<02:06, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  61%|██████▏   | 6.13G/9.98G [03:22<02:06, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  62%|██████▏   | 6.14G/9.98G [03:23<02:06, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  62%|██████▏   | 6.16G/9.98G [03:23<02:06, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  62%|██████▏   | 6.17G/9.98G [03:23<02:05, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  62%|██████▏   | 6.18G/9.98G [03:24<02:04, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  62%|██████▏   | 6.19G/9.98G [03:24<02:04, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  62%|██████▏   | 6.20G/9.98G [03:24<02:21, 26.7MB/s][A
Downloading (…)of-00002.safetensors:  62%|██████▏   | 6.21G/9.98G [03:25<02:13, 28.2MB/s][A
Downloading (…)of-00002.safetensors:  62%|██████▏   | 6.22G/9.98G [03:25<02:09, 29.1MB/s][A
Downloading (…)of-00002.safetensors:  62%|██████▏   | 6.23G/9.98G [03:25<02:07, 29.4MB/s][A
Downloading (…)of-00002.safetensors:  63%|██████▎   | 6.24G/9.98G [03:26<02:05, 29.7MB/s][A
Downloading (…)of-00002.safetensors:  63%|██████▎   | 6.25G/9.98G [03:26<02:03, 30.2MB/s][A
Downloading (…)of-00002.safetensors:  63%|██████▎   | 6.26G/9.98G [03:26<02:02, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  63%|██████▎   | 6.27G/9.98G [03:27<02:02, 30.2MB/s][A
Downloading (…)of-00002.safetensors:  63%|██████▎   | 6.28G/9.98G [03:27<01:59, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  63%|██████▎   | 6.29G/9.98G [03:28<01:59, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  63%|██████▎   | 6.30G/9.98G [03:28<01:59, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  63%|██████▎   | 6.31G/9.98G [03:28<01:59, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  63%|██████▎   | 6.32G/9.98G [03:29<01:58, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  63%|██████▎   | 6.33G/9.98G [03:29<01:56, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  64%|██████▎   | 6.34G/9.98G [03:29<01:56, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  64%|██████▎   | 6.35G/9.98G [03:30<01:55, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  64%|██████▍   | 6.36G/9.98G [03:30<01:53, 31.8MB/s][A
Downloading (…)of-00002.safetensors:  64%|██████▍   | 6.38G/9.98G [03:30<01:53, 31.7MB/s][A
Downloading (…)of-00002.safetensors:  64%|██████▍   | 6.39G/9.98G [03:31<01:54, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  64%|██████▍   | 6.40G/9.98G [03:31<01:55, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  64%|██████▍   | 6.41G/9.98G [03:31<01:55, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  64%|██████▍   | 6.42G/9.98G [03:32<01:55, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  64%|██████▍   | 6.43G/9.98G [03:32<01:55, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  65%|██████▍   | 6.44G/9.98G [03:32<01:56, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  65%|██████▍   | 6.45G/9.98G [03:33<01:54, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  65%|██████▍   | 6.46G/9.98G [03:33<01:52, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  65%|██████▍   | 6.47G/9.98G [03:33<01:53, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  65%|██████▍   | 6.48G/9.98G [03:34<01:53, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  65%|██████▌   | 6.49G/9.98G [03:34<01:53, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  65%|██████▌   | 6.50G/9.98G [03:34<02:11, 26.4MB/s][A
Downloading (…)of-00002.safetensors:  65%|██████▌   | 6.51G/9.98G [03:35<02:04, 27.7MB/s][A
Downloading (…)of-00002.safetensors:  65%|██████▌   | 6.52G/9.98G [03:35<02:00, 28.6MB/s][A
Downloading (…)of-00002.safetensors:  65%|██████▌   | 6.53G/9.98G [03:35<01:58, 29.2MB/s][A
Downloading (…)of-00002.safetensors:  66%|██████▌   | 6.54G/9.98G [03:36<01:55, 29.7MB/s][A
Downloading (…)of-00002.safetensors:  66%|██████▌   | 6.55G/9.98G [03:36<01:54, 29.9MB/s][A
Downloading (…)of-00002.safetensors:  66%|██████▌   | 6.56G/9.98G [03:37<01:53, 30.0MB/s][A
Downloading (…)of-00002.safetensors:  66%|██████▌   | 6.57G/9.98G [03:37<01:52, 30.2MB/s][A
Downloading (…)of-00002.safetensors:  66%|██████▌   | 6.59G/9.98G [03:37<01:52, 30.2MB/s][A
Downloading (…)of-00002.safetensors:  66%|██████▌   | 6.60G/9.98G [03:38<01:51, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  66%|██████▌   | 6.61G/9.98G [03:38<01:50, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  66%|██████▋   | 6.62G/9.98G [03:38<01:49, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  66%|██████▋   | 6.63G/9.98G [03:39<01:46, 31.5MB/s][A
Downloading (…)of-00002.safetensors:  67%|██████▋   | 6.64G/9.98G [03:39<01:45, 31.7MB/s][A
Downloading (…)of-00002.safetensors:  67%|██████▋   | 6.65G/9.98G [03:39<01:46, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  67%|██████▋   | 6.66G/9.98G [03:40<01:47, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  67%|██████▋   | 6.67G/9.98G [03:40<01:46, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  67%|██████▋   | 6.68G/9.98G [03:40<01:47, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  67%|██████▋   | 6.69G/9.98G [03:41<01:46, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  67%|██████▋   | 6.70G/9.98G [03:41<01:46, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  67%|██████▋   | 6.71G/9.98G [03:41<01:44, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  67%|██████▋   | 6.72G/9.98G [03:42<01:44, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  67%|██████▋   | 6.73G/9.98G [03:42<01:43, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  68%|██████▊   | 6.74G/9.98G [03:42<01:43, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  68%|██████▊   | 6.75G/9.98G [03:43<01:44, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  68%|██████▊   | 6.76G/9.98G [03:43<01:44, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  68%|██████▊   | 6.77G/9.98G [03:43<01:44, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  68%|██████▊   | 6.78G/9.98G [03:44<01:44, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  68%|██████▊   | 6.79G/9.98G [03:44<01:43, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  68%|██████▊   | 6.81G/9.98G [03:44<01:41, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  68%|██████▊   | 6.82G/9.98G [03:45<01:58, 26.7MB/s][A
Downloading (…)of-00002.safetensors:  68%|██████▊   | 6.83G/9.98G [03:45<01:52, 28.1MB/s][A
Downloading (…)of-00002.safetensors:  69%|██████▊   | 6.84G/9.98G [03:45<01:49, 28.8MB/s][A
Downloading (…)of-00002.safetensors:  69%|██████▊   | 6.85G/9.98G [03:46<01:47, 29.2MB/s][A
Downloading (…)of-00002.safetensors:  69%|██████▊   | 6.86G/9.98G [03:46<01:45, 29.5MB/s][A
Downloading (…)of-00002.safetensors:  69%|██████▉   | 6.87G/9.98G [03:47<01:44, 29.8MB/s][A
Downloading (…)of-00002.safetensors:  69%|██████▉   | 6.88G/9.98G [03:47<01:43, 30.1MB/s][A
Downloading (…)of-00002.safetensors:  69%|██████▉   | 6.89G/9.98G [03:47<01:41, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  69%|██████▉   | 6.90G/9.98G [03:48<01:39, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  69%|██████▉   | 6.91G/9.98G [03:48<01:38, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  69%|██████▉   | 6.92G/9.98G [03:48<01:39, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  69%|██████▉   | 6.93G/9.98G [03:49<01:38, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  70%|██████▉   | 6.94G/9.98G [03:49<01:39, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  70%|██████▉   | 6.95G/9.98G [03:49<01:38, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  70%|██████▉   | 6.96G/9.98G [03:50<01:38, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  70%|██████▉   | 6.97G/9.98G [03:50<01:37, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  70%|██████▉   | 6.98G/9.98G [03:50<01:37, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  70%|███████   | 6.99G/9.98G [03:51<01:37, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  70%|███████   | 7.00G/9.98G [03:51<01:36, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  70%|███████   | 7.01G/9.98G [03:51<01:36, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  70%|███████   | 7.03G/9.98G [03:52<01:36, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  71%|███████   | 7.04G/9.98G [03:52<01:36, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  71%|███████   | 7.05G/9.98G [03:52<01:36, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  71%|███████   | 7.06G/9.98G [03:53<01:35, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  71%|███████   | 7.07G/9.98G [03:53<01:34, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  71%|███████   | 7.08G/9.98G [03:53<01:33, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  71%|███████   | 7.09G/9.98G [03:54<01:33, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  71%|███████   | 7.10G/9.98G [03:54<01:31, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  71%|███████▏  | 7.11G/9.98G [03:54<01:31, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  71%|███████▏  | 7.12G/9.98G [03:55<01:48, 26.4MB/s][A
Downloading (…)of-00002.safetensors:  71%|███████▏  | 7.13G/9.98G [03:55<01:42, 27.8MB/s][A
Downloading (…)of-00002.safetensors:  72%|███████▏  | 7.14G/9.98G [03:56<01:39, 28.5MB/s][A
Downloading (…)of-00002.safetensors:  72%|███████▏  | 7.15G/9.98G [03:56<01:37, 29.0MB/s][A
Downloading (…)of-00002.safetensors:  72%|███████▏  | 7.16G/9.98G [03:56<01:35, 29.5MB/s][A
Downloading (…)of-00002.safetensors:  72%|███████▏  | 7.17G/9.98G [03:57<01:34, 29.7MB/s][A
Downloading (…)of-00002.safetensors:  72%|███████▏  | 7.18G/9.98G [03:57<01:33, 30.0MB/s][A
Downloading (…)of-00002.safetensors:  72%|███████▏  | 7.19G/9.98G [03:57<01:32, 30.1MB/s][A
Downloading (…)of-00002.safetensors:  72%|███████▏  | 7.20G/9.98G [03:58<01:31, 30.2MB/s][A
Downloading (…)of-00002.safetensors:  72%|███████▏  | 7.21G/9.98G [03:58<01:31, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  72%|███████▏  | 7.22G/9.98G [03:58<01:29, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  73%|███████▎  | 7.24G/9.98G [03:59<01:26, 31.6MB/s][A
Downloading (…)of-00002.safetensors:  73%|███████▎  | 7.25G/9.98G [03:59<01:24, 32.4MB/s][A
Downloading (…)of-00002.safetensors:  73%|███████▎  | 7.26G/9.98G [03:59<01:22, 32.8MB/s][A
Downloading (…)of-00002.safetensors:  73%|███████▎  | 7.27G/9.98G [04:00<01:21, 33.3MB/s][A
Downloading (…)of-00002.safetensors:  73%|███████▎  | 7.28G/9.98G [04:00<01:21, 33.3MB/s][A
Downloading (…)of-00002.safetensors:  73%|███████▎  | 7.29G/9.98G [04:00<01:22, 32.8MB/s][A
Downloading (…)of-00002.safetensors:  73%|███████▎  | 7.30G/9.98G [04:00<01:22, 32.6MB/s][A
Downloading (…)of-00002.safetensors:  73%|███████▎  | 7.31G/9.98G [04:01<01:23, 31.9MB/s][A
Downloading (…)of-00002.safetensors:  73%|███████▎  | 7.32G/9.98G [04:01<01:24, 31.5MB/s][A
Downloading (…)of-00002.safetensors:  73%|███████▎  | 7.33G/9.98G [04:02<01:25, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  74%|███████▎  | 7.34G/9.98G [04:02<01:25, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  74%|███████▎  | 7.35G/9.98G [04:02<01:25, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  74%|███████▍  | 7.36G/9.98G [04:03<01:25, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  74%|███████▍  | 7.37G/9.98G [04:03<01:25, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  74%|███████▍  | 7.38G/9.98G [04:03<01:24, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  74%|███████▍  | 7.39G/9.98G [04:04<01:23, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  74%|███████▍  | 7.40G/9.98G [04:04<01:22, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  74%|███████▍  | 7.41G/9.98G [04:04<01:21, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  74%|███████▍  | 7.42G/9.98G [04:05<01:22, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  75%|███████▍  | 7.43G/9.98G [04:05<01:35, 26.5MB/s][A
Downloading (…)of-00002.safetensors:  75%|███████▍  | 7.44G/9.98G [04:05<01:30, 28.1MB/s][A
Downloading (…)of-00002.safetensors:  75%|███████▍  | 7.46G/9.98G [04:06<01:26, 29.1MB/s][A
Downloading (…)of-00002.safetensors:  75%|███████▍  | 7.47G/9.98G [04:06<01:25, 29.5MB/s][A
Downloading (…)of-00002.safetensors:  75%|███████▍  | 7.48G/9.98G [04:06<01:24, 29.8MB/s][A
Downloading (…)of-00002.safetensors:  75%|███████▌  | 7.49G/9.98G [04:07<01:23, 29.9MB/s][A
Downloading (…)of-00002.safetensors:  75%|███████▌  | 7.50G/9.98G [04:07<01:22, 30.0MB/s][A
Downloading (…)of-00002.safetensors:  75%|███████▌  | 7.51G/9.98G [04:08<01:22, 30.1MB/s][A
Downloading (…)of-00002.safetensors:  75%|███████▌  | 7.52G/9.98G [04:08<01:21, 30.2MB/s][A
Downloading (…)of-00002.safetensors:  75%|███████▌  | 7.53G/9.98G [04:08<01:21, 30.2MB/s][A
Downloading (…)of-00002.safetensors:  76%|███████▌  | 7.54G/9.98G [04:09<01:20, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  76%|███████▌  | 7.55G/9.98G [04:09<01:19, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  76%|███████▌  | 7.56G/9.98G [04:09<01:19, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  76%|███████▌  | 7.57G/9.98G [04:10<01:19, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  76%|███████▌  | 7.58G/9.98G [04:10<01:17, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  76%|███████▌  | 7.59G/9.98G [04:10<01:17, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  76%|███████▌  | 7.60G/9.98G [04:11<01:17, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  76%|███████▋  | 7.61G/9.98G [04:11<01:17, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  76%|███████▋  | 7.62G/9.98G [04:11<01:16, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  77%|███████▋  | 7.63G/9.98G [04:12<01:16, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  77%|███████▋  | 7.64G/9.98G [04:12<01:14, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  77%|███████▋  | 7.65G/9.98G [04:12<01:14, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  77%|███████▋  | 7.67G/9.98G [04:13<01:14, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  77%|███████▋  | 7.68G/9.98G [04:13<01:14, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  77%|███████▋  | 7.69G/9.98G [04:13<01:12, 31.5MB/s][A
Downloading (…)of-00002.safetensors:  77%|███████▋  | 7.70G/9.98G [04:14<01:13, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  77%|███████▋  | 7.71G/9.98G [04:14<01:11, 31.6MB/s][A
Downloading (…)of-00002.safetensors:  77%|███████▋  | 7.72G/9.98G [04:14<01:11, 31.7MB/s][A
Downloading (…)of-00002.safetensors:  77%|███████▋  | 7.73G/9.98G [04:15<01:11, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  78%|███████▊  | 7.74G/9.98G [04:15<01:11, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  78%|███████▊  | 7.75G/9.98G [04:15<01:22, 26.9MB/s][A
Downloading (…)of-00002.safetensors:  78%|███████▊  | 7.76G/9.98G [04:16<01:17, 28.7MB/s][A
Downloading (…)of-00002.safetensors:  78%|███████▊  | 7.77G/9.98G [04:16<01:14, 29.6MB/s][A
Downloading (…)of-00002.safetensors:  78%|███████▊  | 7.78G/9.98G [04:16<01:13, 29.8MB/s][A
Downloading (…)of-00002.safetensors:  78%|███████▊  | 7.79G/9.98G [04:17<01:12, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  78%|███████▊  | 7.80G/9.98G [04:17<01:11, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  78%|███████▊  | 7.81G/9.98G [04:17<01:11, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  78%|███████▊  | 7.82G/9.98G [04:18<01:10, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  79%|███████▊  | 7.83G/9.98G [04:18<01:09, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  79%|███████▊  | 7.84G/9.98G [04:18<01:08, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  79%|███████▊  | 7.85G/9.98G [04:19<01:08, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  79%|███████▉  | 7.86G/9.98G [04:19<01:08, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  79%|███████▉  | 7.87G/9.98G [04:19<01:06, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  79%|███████▉  | 7.89G/9.98G [04:20<01:06, 31.5MB/s][A
Downloading (…)of-00002.safetensors:  79%|███████▉  | 7.90G/9.98G [04:20<01:06, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  79%|███████▉  | 7.91G/9.98G [04:20<01:06, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  79%|███████▉  | 7.92G/9.98G [04:21<01:06, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  79%|███████▉  | 7.93G/9.98G [04:21<01:06, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  80%|███████▉  | 7.94G/9.98G [04:21<01:05, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  80%|███████▉  | 7.95G/9.98G [04:22<01:05, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  80%|███████▉  | 7.96G/9.98G [04:22<01:03, 31.7MB/s][A
Downloading (…)of-00002.safetensors:  80%|███████▉  | 7.97G/9.98G [04:22<01:01, 32.4MB/s][A
Downloading (…)of-00002.safetensors:  80%|███████▉  | 7.98G/9.98G [04:23<01:01, 32.7MB/s][A
Downloading (…)of-00002.safetensors:  80%|████████  | 7.99G/9.98G [04:23<01:02, 32.0MB/s][A
Downloading (…)of-00002.safetensors:  80%|████████  | 8.00G/9.98G [04:23<01:02, 31.6MB/s][A
Downloading (…)of-00002.safetensors:  80%|████████  | 8.01G/9.98G [04:24<01:02, 31.5MB/s][A
Downloading (…)of-00002.safetensors:  80%|████████  | 8.02G/9.98G [04:24<01:02, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  81%|████████  | 8.03G/9.98G [04:24<01:01, 31.5MB/s][A
Downloading (…)of-00002.safetensors:  81%|████████  | 8.04G/9.98G [04:25<01:01, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  81%|████████  | 8.05G/9.98G [04:25<01:01, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  81%|████████  | 8.06G/9.98G [04:26<01:11, 26.6MB/s][A
Downloading (…)of-00002.safetensors:  81%|████████  | 8.07G/9.98G [04:26<01:08, 27.9MB/s][A
Downloading (…)of-00002.safetensors:  81%|████████  | 8.08G/9.98G [04:26<01:06, 28.6MB/s][A
Downloading (…)of-00002.safetensors:  81%|████████  | 8.10G/9.98G [04:27<01:04, 29.1MB/s][A
Downloading (…)of-00002.safetensors:  81%|████████  | 8.11G/9.98G [04:27<01:03, 29.5MB/s][A
Downloading (…)of-00002.safetensors:  81%|████████▏ | 8.12G/9.98G [04:27<01:02, 29.7MB/s][A
Downloading (…)of-00002.safetensors:  81%|████████▏ | 8.13G/9.98G [04:28<01:01, 29.9MB/s][A
Downloading (…)of-00002.safetensors:  82%|████████▏ | 8.14G/9.98G [04:28<01:01, 30.0MB/s][A
Downloading (…)of-00002.safetensors:  82%|████████▏ | 8.15G/9.98G [04:28<01:00, 30.1MB/s][A
Downloading (…)of-00002.safetensors:  82%|████████▏ | 8.16G/9.98G [04:29<01:00, 30.2MB/s][A
Downloading (…)of-00002.safetensors:  82%|████████▏ | 8.17G/9.98G [04:29<00:59, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  82%|████████▏ | 8.18G/9.98G [04:29<00:58, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  82%|████████▏ | 8.19G/9.98G [04:30<00:58, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  82%|████████▏ | 8.20G/9.98G [04:30<00:58, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  82%|████████▏ | 8.21G/9.98G [04:30<00:57, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  82%|████████▏ | 8.22G/9.98G [04:31<00:57, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  83%|████████▎ | 8.23G/9.98G [04:31<00:57, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  83%|████████▎ | 8.24G/9.98G [04:31<00:56, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  83%|████████▎ | 8.25G/9.98G [04:32<00:55, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  83%|████████▎ | 8.26G/9.98G [04:32<00:55, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  83%|████████▎ | 8.27G/9.98G [04:32<00:54, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  83%|████████▎ | 8.28G/9.98G [04:33<00:54, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  83%|████████▎ | 8.29G/9.98G [04:33<00:54, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  83%|████████▎ | 8.30G/9.98G [04:34<00:54, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  83%|████████▎ | 8.32G/9.98G [04:34<00:53, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  83%|████████▎ | 8.33G/9.98G [04:34<00:52, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  84%|████████▎ | 8.34G/9.98G [04:34<00:51, 32.1MB/s][A
Downloading (…)of-00002.safetensors:  84%|████████▎ | 8.35G/9.98G [04:35<00:49, 32.7MB/s][A
Downloading (…)of-00002.safetensors:  84%|████████▍ | 8.36G/9.98G [04:35<00:48, 33.2MB/s][A
Downloading (…)of-00002.safetensors:  84%|████████▍ | 8.37G/9.98G [04:35<00:48, 33.5MB/s][A
Downloading (…)of-00002.safetensors:  84%|████████▍ | 8.38G/9.98G [04:36<00:56, 28.2MB/s][A
Downloading (…)of-00002.safetensors:  84%|████████▍ | 8.39G/9.98G [04:36<00:54, 29.0MB/s][A
Downloading (…)of-00002.safetensors:  84%|████████▍ | 8.40G/9.98G [04:37<00:53, 29.6MB/s][A
Downloading (…)of-00002.safetensors:  84%|████████▍ | 8.41G/9.98G [04:37<00:52, 30.0MB/s][A
Downloading (…)of-00002.safetensors:  84%|████████▍ | 8.42G/9.98G [04:37<00:51, 30.1MB/s][A
Downloading (…)of-00002.safetensors:  85%|████████▍ | 8.43G/9.98G [04:38<00:50, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  85%|████████▍ | 8.44G/9.98G [04:38<00:50, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  85%|████████▍ | 8.45G/9.98G [04:38<00:48, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  85%|████████▍ | 8.46G/9.98G [04:39<00:47, 31.6MB/s][A
Downloading (…)of-00002.safetensors:  85%|████████▍ | 8.47G/9.98G [04:39<00:48, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  85%|████████▌ | 8.48G/9.98G [04:39<00:48, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  85%|████████▌ | 8.49G/9.98G [04:40<00:47, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  85%|████████▌ | 8.50G/9.98G [04:40<00:47, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  85%|████████▌ | 8.51G/9.98G [04:40<00:47, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  85%|████████▌ | 8.52G/9.98G [04:41<00:47, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  86%|████████▌ | 8.54G/9.98G [04:41<00:46, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  86%|████████▌ | 8.55G/9.98G [04:41<00:46, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  86%|████████▌ | 8.56G/9.98G [04:42<00:45, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  86%|████████▌ | 8.57G/9.98G [04:42<00:44, 31.4MB/s][A
Downloading (…)of-00002.safetensors:  86%|████████▌ | 8.58G/9.98G [04:42<00:44, 31.7MB/s][A
Downloading (…)of-00002.safetensors:  86%|████████▌ | 8.59G/9.98G [04:43<00:43, 31.8MB/s][A
Downloading (…)of-00002.safetensors:  86%|████████▌ | 8.60G/9.98G [04:43<00:43, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  86%|████████▋ | 8.61G/9.98G [04:43<00:44, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  86%|████████▋ | 8.62G/9.98G [04:44<00:44, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  87%|████████▋ | 8.63G/9.98G [04:44<00:43, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  87%|████████▋ | 8.64G/9.98G [04:44<00:43, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  87%|████████▋ | 8.65G/9.98G [04:45<00:42, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  87%|████████▋ | 8.66G/9.98G [04:45<00:42, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  87%|████████▋ | 8.67G/9.98G [04:45<00:42, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  87%|████████▋ | 8.68G/9.98G [04:46<00:42, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  87%|████████▋ | 8.69G/9.98G [04:46<00:56, 22.8MB/s][A
Downloading (…)of-00002.safetensors:  87%|████████▋ | 8.70G/9.98G [04:47<00:51, 24.7MB/s][A
Downloading (…)of-00002.safetensors:  87%|████████▋ | 8.71G/9.98G [04:47<00:48, 26.2MB/s][A
Downloading (…)of-00002.safetensors:  87%|████████▋ | 8.72G/9.98G [04:47<00:45, 27.3MB/s][A
Downloading (…)of-00002.safetensors:  88%|████████▊ | 8.73G/9.98G [04:48<00:43, 28.2MB/s][A
Downloading (…)of-00002.safetensors:  88%|████████▊ | 8.75G/9.98G [04:48<00:41, 29.6MB/s][A
Downloading (…)of-00002.safetensors:  88%|████████▊ | 8.76G/9.98G [04:48<00:39, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  88%|████████▊ | 8.77G/9.98G [04:49<00:38, 31.8MB/s][A
Downloading (…)of-00002.safetensors:  88%|████████▊ | 8.78G/9.98G [04:49<00:36, 32.5MB/s][A
Downloading (…)of-00002.safetensors:  88%|████████▊ | 8.79G/9.98G [04:49<00:36, 33.0MB/s][A
Downloading (…)of-00002.safetensors:  88%|████████▊ | 8.80G/9.98G [04:50<00:35, 33.3MB/s][A
Downloading (…)of-00002.safetensors:  88%|████████▊ | 8.81G/9.98G [04:50<00:34, 33.6MB/s][A
Downloading (…)of-00002.safetensors:  88%|████████▊ | 8.82G/9.98G [04:50<00:34, 33.9MB/s][A
Downloading (…)of-00002.safetensors:  88%|████████▊ | 8.83G/9.98G [04:51<00:33, 34.2MB/s][A
Downloading (…)of-00002.safetensors:  89%|████████▊ | 8.84G/9.98G [04:51<00:33, 34.1MB/s][A
Downloading (…)of-00002.safetensors:  89%|████████▊ | 8.85G/9.98G [04:51<00:33, 34.1MB/s][A
Downloading (…)of-00002.safetensors:  89%|████████▉ | 8.86G/9.98G [04:51<00:32, 34.1MB/s][A
Downloading (…)of-00002.safetensors:  89%|████████▉ | 8.87G/9.98G [04:52<00:32, 34.1MB/s][A
Downloading (…)of-00002.safetensors:  89%|████████▉ | 8.88G/9.98G [04:52<00:32, 33.4MB/s][A
Downloading (…)of-00002.safetensors:  89%|████████▉ | 8.89G/9.98G [04:52<00:33, 32.7MB/s][A
Downloading (…)of-00002.safetensors:  89%|████████▉ | 8.90G/9.98G [04:53<00:33, 32.2MB/s][A
Downloading (…)of-00002.safetensors:  89%|████████▉ | 8.91G/9.98G [04:53<00:33, 31.8MB/s][A
Downloading (…)of-00002.safetensors:  89%|████████▉ | 8.92G/9.98G [04:53<00:33, 31.6MB/s][A
Downloading (…)of-00002.safetensors:  90%|████████▉ | 8.93G/9.98G [04:54<00:33, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  90%|████████▉ | 8.94G/9.98G [04:54<00:32, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  90%|████████▉ | 8.95G/9.98G [04:54<00:32, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  90%|████████▉ | 8.97G/9.98G [04:55<00:32, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  90%|████████▉ | 8.98G/9.98G [04:55<00:32, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  90%|█████████ | 8.99G/9.98G [04:55<00:31, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  90%|█████████ | 9.00G/9.98G [04:56<00:31, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  90%|█████████ | 9.01G/9.98G [04:56<00:36, 26.3MB/s][A
Downloading (…)of-00002.safetensors:  90%|█████████ | 9.02G/9.98G [04:57<00:34, 27.6MB/s][A
Downloading (…)of-00002.safetensors:  90%|█████████ | 9.03G/9.98G [04:57<00:33, 28.6MB/s][A
Downloading (…)of-00002.safetensors:  91%|█████████ | 9.04G/9.98G [04:57<00:32, 29.3MB/s][A
Downloading (…)of-00002.safetensors:  91%|█████████ | 9.05G/9.98G [04:58<00:31, 29.6MB/s][A
Downloading (…)of-00002.safetensors:  91%|█████████ | 9.06G/9.98G [04:58<00:30, 30.1MB/s][A
Downloading (…)of-00002.safetensors:  91%|█████████ | 9.07G/9.98G [04:58<00:29, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  91%|█████████ | 9.08G/9.98G [04:59<00:29, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  91%|█████████ | 9.09G/9.98G [04:59<00:28, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  91%|█████████ | 9.10G/9.98G [04:59<00:28, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  91%|█████████▏| 9.11G/9.98G [05:00<00:27, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  91%|█████████▏| 9.12G/9.98G [05:00<00:27, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  92%|█████████▏| 9.13G/9.98G [05:00<00:27, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  92%|█████████▏| 9.14G/9.98G [05:01<00:27, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  92%|█████████▏| 9.15G/9.98G [05:01<00:26, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  92%|█████████▏| 9.16G/9.98G [05:01<00:25, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  92%|█████████▏| 9.18G/9.98G [05:02<00:25, 31.7MB/s][A
Downloading (…)of-00002.safetensors:  92%|█████████▏| 9.19G/9.98G [05:02<00:25, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  92%|█████████▏| 9.20G/9.98G [05:02<00:25, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  92%|█████████▏| 9.21G/9.98G [05:03<00:24, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  92%|█████████▏| 9.22G/9.98G [05:03<00:24, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  92%|█████████▏| 9.23G/9.98G [05:03<00:24, 31.2MB/s][A
Downloading (…)of-00002.safetensors:  93%|█████████▎| 9.24G/9.98G [05:04<00:23, 30.9MB/s][A
Downloading (…)of-00002.safetensors:  93%|█████████▎| 9.25G/9.98G [05:04<00:23, 31.0MB/s][A
Downloading (…)of-00002.safetensors:  93%|█████████▎| 9.26G/9.98G [05:04<00:22, 32.0MB/s][A
Downloading (…)of-00002.safetensors:  93%|█████████▎| 9.27G/9.98G [05:05<00:21, 32.4MB/s][A
Downloading (…)of-00002.safetensors:  93%|█████████▎| 9.28G/9.98G [05:05<00:21, 32.5MB/s][A
Downloading (…)of-00002.safetensors:  93%|█████████▎| 9.29G/9.98G [05:05<00:21, 31.9MB/s][A
Downloading (…)of-00002.safetensors:  93%|█████████▎| 9.30G/9.98G [05:06<00:21, 31.5MB/s][A
Downloading (…)of-00002.safetensors:  93%|█████████▎| 9.31G/9.98G [05:06<00:21, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  93%|█████████▎| 9.32G/9.98G [05:07<00:24, 26.4MB/s][A
Downloading (…)of-00002.safetensors:  94%|█████████▎| 9.33G/9.98G [05:07<00:23, 27.9MB/s][A
Downloading (…)of-00002.safetensors:  94%|█████████▎| 9.34G/9.98G [05:07<00:21, 28.9MB/s][A
Downloading (…)of-00002.safetensors:  94%|█████████▍| 9.35G/9.98G [05:08<00:21, 29.5MB/s][A
Downloading (…)of-00002.safetensors:  94%|█████████▍| 9.36G/9.98G [05:08<00:20, 30.0MB/s][A
Downloading (…)of-00002.safetensors:  94%|█████████▍| 9.37G/9.98G [05:08<00:19, 30.1MB/s][A
Downloading (…)of-00002.safetensors:  94%|█████████▍| 9.38G/9.98G [05:09<00:19, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  94%|█████████▍| 9.40G/9.98G [05:09<00:19, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  94%|█████████▍| 9.41G/9.98G [05:09<00:18, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  94%|█████████▍| 9.42G/9.98G [05:10<00:18, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  94%|█████████▍| 9.43G/9.98G [05:10<00:18, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  95%|█████████▍| 9.44G/9.98G [05:10<00:17, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  95%|█████████▍| 9.45G/9.98G [05:11<00:17, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  95%|█████████▍| 9.46G/9.98G [05:11<00:16, 31.6MB/s][A
Downloading (…)of-00002.safetensors:  95%|█████████▍| 9.47G/9.98G [05:11<00:15, 32.4MB/s][A
Downloading (…)of-00002.safetensors:  95%|█████████▌| 9.48G/9.98G [05:12<00:15, 32.9MB/s][A
Downloading (…)of-00002.safetensors:  95%|█████████▌| 9.49G/9.98G [05:12<00:14, 33.3MB/s][A
Downloading (…)of-00002.safetensors:  95%|█████████▌| 9.50G/9.98G [05:12<00:14, 33.2MB/s][A
Downloading (…)of-00002.safetensors:  95%|█████████▌| 9.51G/9.98G [05:13<00:14, 32.3MB/s][A
Downloading (…)of-00002.safetensors:  95%|█████████▌| 9.52G/9.98G [05:13<00:14, 31.9MB/s][A
Downloading (…)of-00002.safetensors:  96%|█████████▌| 9.53G/9.98G [05:13<00:13, 32.4MB/s][A
Downloading (…)of-00002.safetensors:  96%|█████████▌| 9.54G/9.98G [05:14<00:13, 32.8MB/s][A
Downloading (…)of-00002.safetensors:  96%|█████████▌| 9.55G/9.98G [05:14<00:13, 32.2MB/s][A
Downloading (…)of-00002.safetensors:  96%|█████████▌| 9.56G/9.98G [05:14<00:12, 32.5MB/s][A
Downloading (…)of-00002.safetensors:  96%|█████████▌| 9.57G/9.98G [05:15<00:12, 32.1MB/s][A
Downloading (…)of-00002.safetensors:  96%|█████████▌| 9.58G/9.98G [05:15<00:12, 31.7MB/s][A
Downloading (…)of-00002.safetensors:  96%|█████████▌| 9.59G/9.98G [05:15<00:12, 31.3MB/s][A
Downloading (…)of-00002.safetensors:  96%|█████████▋| 9.60G/9.98G [05:16<00:11, 31.1MB/s][A
Downloading (…)of-00002.safetensors:  96%|█████████▋| 9.62G/9.98G [05:16<00:11, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  96%|█████████▋| 9.63G/9.98G [05:16<00:11, 30.8MB/s][A
Downloading (…)of-00002.safetensors:  97%|█████████▋| 9.64G/9.98G [05:17<00:13, 25.9MB/s][A
Downloading (…)of-00002.safetensors:  97%|█████████▋| 9.65G/9.98G [05:17<00:12, 27.2MB/s][A
Downloading (…)of-00002.safetensors:  97%|█████████▋| 9.66G/9.98G [05:18<00:11, 28.2MB/s][A
Downloading (…)of-00002.safetensors:  97%|█████████▋| 9.67G/9.98G [05:18<00:10, 28.9MB/s][A
Downloading (…)of-00002.safetensors:  97%|█████████▋| 9.68G/9.98G [05:18<00:10, 29.5MB/s][A
Downloading (…)of-00002.safetensors:  97%|█████████▋| 9.69G/9.98G [05:19<00:09, 29.8MB/s][A
Downloading (…)of-00002.safetensors:  97%|█████████▋| 9.70G/9.98G [05:19<00:09, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  97%|█████████▋| 9.71G/9.98G [05:19<00:08, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  97%|█████████▋| 9.72G/9.98G [05:20<00:08, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  98%|█████████▊| 9.73G/9.98G [05:20<00:08, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  98%|█████████▊| 9.74G/9.98G [05:20<00:07, 30.6MB/s][A
Downloading (…)of-00002.safetensors:  98%|█████████▊| 9.75G/9.98G [05:21<00:07, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  98%|█████████▊| 9.76G/9.98G [05:21<00:07, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  98%|█████████▊| 9.77G/9.98G [05:21<00:06, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  98%|█████████▊| 9.78G/9.98G [05:22<00:06, 30.7MB/s][A
Downloading (…)of-00002.safetensors:  98%|█████████▊| 9.79G/9.98G [05:22<00:05, 30.5MB/s][A
Downloading (…)of-00002.safetensors:  98%|█████████▊| 9.80G/9.98G [05:22<00:05, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  98%|█████████▊| 9.81G/9.98G [05:23<00:05, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  98%|█████████▊| 9.83G/9.98G [05:23<00:04, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  99%|█████████▊| 9.84G/9.98G [05:23<00:04, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  99%|█████████▊| 9.85G/9.98G [05:24<00:04, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  99%|█████████▉| 9.86G/9.98G [05:24<00:03, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  99%|█████████▉| 9.87G/9.98G [05:24<00:03, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  99%|█████████▉| 9.88G/9.98G [05:25<00:03, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  99%|█████████▉| 9.89G/9.98G [05:25<00:02, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  99%|█████████▉| 9.90G/9.98G [05:25<00:02, 30.3MB/s][A
Downloading (…)of-00002.safetensors:  99%|█████████▉| 9.91G/9.98G [05:26<00:02, 30.4MB/s][A
Downloading (…)of-00002.safetensors:  99%|█████████▉| 9.92G/9.98G [05:26<00:01, 30.4MB/s][A
Downloading (…)of-00002.safetensors: 100%|█████████▉| 9.93G/9.98G [05:26<00:01, 30.6MB/s][A
Downloading (…)of-00002.safetensors: 100%|█████████▉| 9.94G/9.98G [05:27<00:01, 26.1MB/s][A
Downloading (…)of-00002.safetensors: 100%|█████████▉| 9.95G/9.98G [05:27<00:00, 27.4MB/s][A
Downloading (…)of-00002.safetensors: 100%|█████████▉| 9.96G/9.98G [05:28<00:00, 28.2MB/s][A
Downloading (…)of-00002.safetensors: 100%|█████████▉| 9.97G/9.98G [05:28<00:00, 29.1MB/s][A
Downloading (…)of-00002.safetensors: 100%|██████████| 9.98G/9.98G [05:28<00:00, 29.4MB/s][ADownloading (…)of-00002.safetensors: 100%|██████████| 9.98G/9.98G [05:28<00:00, 30.4MB/s]
Downloading shards:  50%|█████     | 1/2 [05:28<05:28, 328.98s/it]
Downloading (…)of-00002.safetensors:   0%|          | 0.00/3.50G [00:00<?, ?B/s][A
Downloading (…)of-00002.safetensors:   0%|          | 10.5M/3.50G [00:00<01:53, 30.8MB/s][A
Downloading (…)of-00002.safetensors:   1%|          | 21.0M/3.50G [00:00<01:54, 30.4MB/s][A
Downloading (…)of-00002.safetensors:   1%|          | 31.5M/3.50G [00:01<01:53, 30.7MB/s][A